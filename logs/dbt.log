[0m19:36:27.317414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e66790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8cf90>]}


============================== 19:36:27.328416 | 465b3d03-c0ff-4031-b8fd-74d259750ad1 ==============================
[0m19:36:27.328416 [info ] [MainThread]: Running with dbt=1.7.7
[0m19:36:27.329312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:36:27.330071 [info ] [MainThread]: dbt version: 1.7.7
[0m19:36:27.330545 [info ] [MainThread]: python version: 3.11.7
[0m19:36:27.331159 [info ] [MainThread]: python path: /usr/local/opt/python@3.11/bin/python3.11
[0m19:36:27.331622 [info ] [MainThread]: os info: macOS-13.6.4-x86_64-i386-64bit
[0m19:36:27.338868 [info ] [MainThread]: Using profiles dir at /Users/gabriellechen/.dbt
[0m19:36:27.339332 [info ] [MainThread]: Using profiles.yml file at /Users/gabriellechen/.dbt/profiles.yml
[0m19:36:27.339774 [info ] [MainThread]: Using dbt_project.yml file at /Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/dbt_project.yml
[0m19:36:27.421203 [info ] [MainThread]: Configuration:
[0m19:36:27.421690 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:36:27.422091 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:36:27.422460 [info ] [MainThread]: Required dependencies:
[0m19:36:27.422956 [debug] [MainThread]: Executing "git --help"
[0m19:36:27.452751 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:36:27.453975 [debug] [MainThread]: STDERR: "b''"
[0m19:36:27.454544 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:36:27.455090 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:36:27.455624 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:36:27.456063 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'jaffle_shop'


[0m19:36:27.459272 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.20643075, "process_user_time": 2.301103, "process_kernel_time": 0.45493, "process_mem_max_rss": "98791424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:27.460235 [debug] [MainThread]: Command `dbt debug` failed at 19:36:27.460046 after 0.21 seconds
[0m19:36:27.461059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10394cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618ff50>]}
[0m19:36:27.461906 [debug] [MainThread]: Flushing usage events
[0m19:37:28.727837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113107990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113107d90>]}


============================== 19:37:28.732583 | 8603a0a7-bca8-44fb-a8ee-450f789ec07c ==============================
[0m19:37:28.732583 [info ] [MainThread]: Running with dbt=1.7.7
[0m19:37:28.733397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:37:28.734105 [info ] [MainThread]: dbt version: 1.7.7
[0m19:37:28.734865 [info ] [MainThread]: python version: 3.11.7
[0m19:37:28.735465 [info ] [MainThread]: python path: /usr/local/opt/python@3.11/bin/python3.11
[0m19:37:28.735978 [info ] [MainThread]: os info: macOS-13.6.4-x86_64-i386-64bit
[0m19:37:29.713028 [info ] [MainThread]: Using profiles dir at /Users/gabriellechen/.dbt
[0m19:37:29.713564 [info ] [MainThread]: Using profiles.yml file at /Users/gabriellechen/.dbt/profiles.yml
[0m19:37:29.713967 [info ] [MainThread]: Using dbt_project.yml file at /Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/dbt_project.yml
[0m19:37:29.715010 [info ] [MainThread]: adapter type: snowflake
[0m19:37:29.715533 [info ] [MainThread]: adapter version: 1.7.1
[0m19:37:29.800677 [info ] [MainThread]: Configuration:
[0m19:37:29.801266 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:37:29.801645 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:37:29.802045 [info ] [MainThread]: Required dependencies:
[0m19:37:29.802540 [debug] [MainThread]: Executing "git --help"
[0m19:37:29.825200 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:37:29.827150 [debug] [MainThread]: STDERR: "b''"
[0m19:37:29.827636 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:37:29.828054 [info ] [MainThread]: Connection:
[0m19:37:29.828462 [info ] [MainThread]:   account: XCB20618
[0m19:37:29.828789 [info ] [MainThread]:   user: gc236
[0m19:37:29.829194 [info ] [MainThread]:   database: analytics
[0m19:37:29.830355 [info ] [MainThread]:   warehouse: transforming
[0m19:37:29.831338 [info ] [MainThread]:   role: accountadmin
[0m19:37:29.832082 [info ] [MainThread]:   schema: jaffle_shop
[0m19:37:29.832898 [info ] [MainThread]:   authenticator: None
[0m19:37:29.833375 [info ] [MainThread]:   private_key_path: None
[0m19:37:29.833800 [info ] [MainThread]:   token: None
[0m19:37:29.834220 [info ] [MainThread]:   oauth_client_id: None
[0m19:37:29.834724 [info ] [MainThread]:   query_tag: None
[0m19:37:29.835093 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:37:29.835566 [info ] [MainThread]:   host: None
[0m19:37:29.835921 [info ] [MainThread]:   port: None
[0m19:37:29.836276 [info ] [MainThread]:   proxy_host: None
[0m19:37:29.836616 [info ] [MainThread]:   proxy_port: None
[0m19:37:29.836975 [info ] [MainThread]:   protocol: None
[0m19:37:29.837316 [info ] [MainThread]:   connect_retries: 0
[0m19:37:29.837911 [info ] [MainThread]:   connect_timeout: 10
[0m19:37:29.838366 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:37:29.838913 [info ] [MainThread]:   retry_all: False
[0m19:37:29.839298 [info ] [MainThread]:   insecure_mode: False
[0m19:37:29.839874 [info ] [MainThread]:   reuse_connections: False
[0m19:37:29.841231 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:37:29.854867 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:37:29.857874 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:37:29.859341 [debug] [MainThread]: On debug: select 1 as id
[0m19:37:29.860050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:30.458619 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m19:37:30.459256 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m19:37:30.459904 [debug] [MainThread]: On debug: No close available on handle
[0m19:37:30.460466 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m19:37:30.461063 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:37:30.461588 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB. Verify the account name is correct: XCB20618.snowflakecomputing.com:443. HTTP 403: Forbidden

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m19:37:30.463936 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.7890418, "process_user_time": 2.387365, "process_kernel_time": 0.304593, "process_mem_max_rss": "118296576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:37:30.464830 [debug] [MainThread]: Command `dbt debug` failed at 19:37:30.464635 after 1.79 seconds
[0m19:37:30.465597 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:37:30.466337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113107e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113896750>]}
[0m19:37:30.467171 [debug] [MainThread]: Flushing usage events
[0m19:41:50.940376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f2ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f37cd0>]}


============================== 19:41:50.944869 | 754dd1b3-46cb-490a-b7ed-0e3a517dec2e ==============================
[0m19:41:50.944869 [info ] [MainThread]: Running with dbt=1.7.7
[0m19:41:50.945672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:41:50.946534 [info ] [MainThread]: dbt version: 1.7.7
[0m19:41:50.947294 [info ] [MainThread]: python version: 3.11.7
[0m19:41:50.947913 [info ] [MainThread]: python path: /usr/local/opt/python@3.11/bin/python3.11
[0m19:41:50.948646 [info ] [MainThread]: os info: macOS-13.6.4-x86_64-i386-64bit
[0m19:41:51.190860 [info ] [MainThread]: Using profiles dir at /Users/gabriellechen/.dbt
[0m19:41:51.191413 [info ] [MainThread]: Using profiles.yml file at /Users/gabriellechen/.dbt/profiles.yml
[0m19:41:51.191806 [info ] [MainThread]: Using dbt_project.yml file at /Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/dbt_project.yml
[0m19:41:51.192411 [info ] [MainThread]: adapter type: snowflake
[0m19:41:51.192870 [info ] [MainThread]: adapter version: 1.7.1
[0m19:41:51.274781 [info ] [MainThread]: Configuration:
[0m19:41:51.275294 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:41:51.275707 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:41:51.276073 [info ] [MainThread]: Required dependencies:
[0m19:41:51.276602 [debug] [MainThread]: Executing "git --help"
[0m19:41:51.297536 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:41:51.298627 [debug] [MainThread]: STDERR: "b''"
[0m19:41:51.299236 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:41:51.299973 [info ] [MainThread]: Connection:
[0m19:41:51.300567 [info ] [MainThread]:   account: TEB88359
[0m19:41:51.301069 [info ] [MainThread]:   user: gc236
[0m19:41:51.301761 [info ] [MainThread]:   database: analytics
[0m19:41:51.302561 [info ] [MainThread]:   warehouse: transforming
[0m19:41:51.303097 [info ] [MainThread]:   role: accountadmin
[0m19:41:51.303564 [info ] [MainThread]:   schema: jaffle_shop
[0m19:41:51.303971 [info ] [MainThread]:   authenticator: None
[0m19:41:51.304372 [info ] [MainThread]:   private_key_path: None
[0m19:41:51.304715 [info ] [MainThread]:   token: None
[0m19:41:51.305067 [info ] [MainThread]:   oauth_client_id: None
[0m19:41:51.305408 [info ] [MainThread]:   query_tag: None
[0m19:41:51.305751 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:41:51.306093 [info ] [MainThread]:   host: None
[0m19:41:51.306435 [info ] [MainThread]:   port: None
[0m19:41:51.306772 [info ] [MainThread]:   proxy_host: None
[0m19:41:51.307118 [info ] [MainThread]:   proxy_port: None
[0m19:41:51.307528 [info ] [MainThread]:   protocol: None
[0m19:41:51.307938 [info ] [MainThread]:   connect_retries: 0
[0m19:41:51.308369 [info ] [MainThread]:   connect_timeout: 10
[0m19:41:51.308842 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:41:51.309198 [info ] [MainThread]:   retry_all: False
[0m19:41:51.309541 [info ] [MainThread]:   insecure_mode: False
[0m19:41:51.309881 [info ] [MainThread]:   reuse_connections: False
[0m19:41:51.310400 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:41:51.316817 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:41:51.319252 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:41:51.319820 [debug] [MainThread]: On debug: select 1 as id
[0m19:41:51.320374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:51.893118 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:41:51.895172 [debug] [MainThread]: On debug: Close
[0m19:41:52.005812 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:41:52.006638 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:41:52.008872 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.12162, "process_user_time": 2.232926, "process_kernel_time": 0.23897, "process_mem_max_rss": "116953088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:52.009811 [debug] [MainThread]: Command `dbt debug` succeeded at 19:41:52.009595 after 1.12 seconds
[0m19:41:52.010363 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:41:52.010870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f5ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f5bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109868490>]}
[0m19:41:52.011388 [debug] [MainThread]: Flushing usage events
[0m19:42:29.243963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62fd10>]}


============================== 19:42:29.249600 | a95e4a42-2c02-4540-89e5-022b71edbfcb ==============================
[0m19:42:29.249600 [info ] [MainThread]: Running with dbt=1.7.7
[0m19:42:29.250613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s customers', 'send_anonymous_usage_stats': 'True'}
[0m19:42:29.600066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ed590>]}
[0m19:42:29.687614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adcedd0>]}
[0m19:42:29.688418 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:42:29.709912 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m19:42:29.710925 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:42:29.711499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b815fd0>]}
[0m19:42:31.056993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc59190>]}
[0m19:42:31.071136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd91790>]}
[0m19:42:31.071619 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m19:42:31.072060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b98d390>]}
[0m19:42:31.073794 [info ] [MainThread]: 
[0m19:42:31.074685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:42:31.075719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m19:42:31.090294 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m19:42:31.090728 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m19:42:31.091067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:31.698023 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:42:31.701075 [debug] [ThreadPool]: On list_analytics: Close
[0m19:42:31.829395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_jaffle_shop)
[0m19:42:31.830574 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "jaffle_shop"
"
[0m19:42:31.839917 [debug] [ThreadPool]: Using snowflake connection "create_analytics_jaffle_shop"
[0m19:42:31.840439 [debug] [ThreadPool]: On create_analytics_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_analytics_jaffle_shop"} */
create schema if not exists analytics.jaffle_shop
[0m19:42:31.840776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:32.578238 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:42:32.580090 [debug] [ThreadPool]: On create_analytics_jaffle_shop: Close
[0m19:42:32.680472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_jaffle_shop, now list_analytics_jaffle_shop)
[0m19:42:32.690591 [debug] [ThreadPool]: Using snowflake connection "list_analytics_jaffle_shop"
[0m19:42:32.691108 [debug] [ThreadPool]: On list_analytics_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_analytics_jaffle_shop"} */
show terse objects in analytics.jaffle_shop limit 10000
[0m19:42:32.691509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:33.028149 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m19:42:33.030199 [debug] [ThreadPool]: On list_analytics_jaffle_shop: Close
[0m19:42:33.119849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baf7850>]}
[0m19:42:33.121122 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:42:33.121763 [info ] [MainThread]: 
[0m19:42:33.135961 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m19:42:33.136591 [info ] [Thread-1 (]: 1 of 1 START sql table model jaffle_shop.customers ............................. [RUN]
[0m19:42:33.137354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_jaffle_shop, now model.jaffle_shop.customers)
[0m19:42:33.137768 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m19:42:33.145564 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m19:42:33.147303 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 19:42:33.138022 => 19:42:33.146776
[0m19:42:33.148022 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m19:42:33.181000 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m19:42:33.183515 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m19:42:33.183970 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace transient table analytics.jaffle_shop.customers
         as
        (with customers as (

    select * from analytics.jaffle_shop.stg_customers

),

orders as (

    select * from analytics.jaffle_shop.stg_orders

),

payments as (

    select * from analytics.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m19:42:33.184404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:33.716216 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2347e-0002-0af9-0000-0050d58710e1
[0m19:42:33.717041 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ANALYTICS.JAFFLE_SHOP.STG_CUSTOMERS' does not exist or not authorized.
[0m19:42:33.717805 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 19:42:33.148452 => 19:42:33.717478
[0m19:42:33.718362 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m19:42:33.818826 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.JAFFLE_SHOP.STG_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m19:42:33.819749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a95e4a42-2c02-4540-89e5-022b71edbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc8b490>]}
[0m19:42:33.820582 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model jaffle_shop.customers .................... [[31mERROR[0m in 0.68s]
[0m19:42:33.821583 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m19:42:33.824343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:33.824947 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m19:42:33.825473 [info ] [MainThread]: 
[0m19:42:33.826011 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m19:42:33.826805 [debug] [MainThread]: Command end result
[0m19:42:33.840605 [info ] [MainThread]: 
[0m19:42:33.841260 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:42:33.841908 [info ] [MainThread]: 
[0m19:42:33.842386 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'ANALYTICS.JAFFLE_SHOP.STG_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m19:42:33.842901 [info ] [MainThread]: 
[0m19:42:33.843376 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:42:33.844836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.652576, "process_user_time": 3.918096, "process_kernel_time": 0.314558, "process_mem_max_rss": "133283840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:33.845443 [debug] [MainThread]: Command `dbt run` failed at 19:42:33.845308 after 4.65 seconds
[0m19:42:33.845984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5c9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be32090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf7210>]}
[0m19:42:33.846636 [debug] [MainThread]: Flushing usage events
[0m19:46:02.067267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d33cd0>]}


============================== 19:46:02.071750 | 368e44d1-2781-4254-8686-629a1d8abe71 ==============================
[0m19:46:02.071750 [info ] [MainThread]: Running with dbt=1.7.7
[0m19:46:02.072417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:46:02.073056 [info ] [MainThread]: dbt version: 1.7.7
[0m19:46:02.073524 [info ] [MainThread]: python version: 3.11.7
[0m19:46:02.074171 [info ] [MainThread]: python path: /usr/local/opt/python@3.11/bin/python3.11
[0m19:46:02.074564 [info ] [MainThread]: os info: macOS-13.6.4-x86_64-i386-64bit
[0m19:46:02.322487 [info ] [MainThread]: Using profiles dir at /Users/gabriellechen/.dbt
[0m19:46:02.323062 [info ] [MainThread]: Using profiles.yml file at /Users/gabriellechen/.dbt/profiles.yml
[0m19:46:02.323462 [info ] [MainThread]: Using dbt_project.yml file at /Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/dbt_project.yml
[0m19:46:02.324037 [info ] [MainThread]: adapter type: snowflake
[0m19:46:02.324545 [info ] [MainThread]: adapter version: 1.7.1
[0m19:46:02.410330 [info ] [MainThread]: Configuration:
[0m19:46:02.410909 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:46:02.411395 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:46:02.411846 [info ] [MainThread]: Required dependencies:
[0m19:46:02.412470 [debug] [MainThread]: Executing "git --help"
[0m19:46:02.435097 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:46:02.437022 [debug] [MainThread]: STDERR: "b''"
[0m19:46:02.437719 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:46:02.438365 [info ] [MainThread]: Connection:
[0m19:46:02.439175 [info ] [MainThread]:   account: TEB88359
[0m19:46:02.439586 [info ] [MainThread]:   user: gc236
[0m19:46:02.440060 [info ] [MainThread]:   database: raw
[0m19:46:02.440418 [info ] [MainThread]:   warehouse: transforming
[0m19:46:02.440768 [info ] [MainThread]:   role: accountadmin
[0m19:46:02.441128 [info ] [MainThread]:   schema: jaffle_shop
[0m19:46:02.441478 [info ] [MainThread]:   authenticator: None
[0m19:46:02.441852 [info ] [MainThread]:   private_key_path: None
[0m19:46:02.442214 [info ] [MainThread]:   token: None
[0m19:46:02.442556 [info ] [MainThread]:   oauth_client_id: None
[0m19:46:02.442898 [info ] [MainThread]:   query_tag: None
[0m19:46:02.443237 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:46:02.443585 [info ] [MainThread]:   host: None
[0m19:46:02.444082 [info ] [MainThread]:   port: None
[0m19:46:02.444524 [info ] [MainThread]:   proxy_host: None
[0m19:46:02.445033 [info ] [MainThread]:   proxy_port: None
[0m19:46:02.445399 [info ] [MainThread]:   protocol: None
[0m19:46:02.445756 [info ] [MainThread]:   connect_retries: 0
[0m19:46:02.446086 [info ] [MainThread]:   connect_timeout: 10
[0m19:46:02.446414 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:46:02.446737 [info ] [MainThread]:   retry_all: False
[0m19:46:02.447118 [info ] [MainThread]:   insecure_mode: False
[0m19:46:02.447715 [info ] [MainThread]:   reuse_connections: False
[0m19:46:02.448412 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:46:02.455557 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:46:02.457854 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:46:02.458232 [debug] [MainThread]: On debug: select 1 as id
[0m19:46:02.458640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:03.326568 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:46:03.328470 [debug] [MainThread]: On debug: Close
[0m19:46:03.420013 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:46:03.420888 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:46:03.424039 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.411899, "process_user_time": 2.255273, "process_kernel_time": 0.240238, "process_mem_max_rss": "117473280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:03.424921 [debug] [MainThread]: Command `dbt debug` succeeded at 19:46:03.424690 after 1.41 seconds
[0m19:46:03.425392 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:46:03.425860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d53f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d518d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10176e110>]}
[0m19:46:03.426397 [debug] [MainThread]: Flushing usage events
[0m19:47:15.696642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059abd90>]}


============================== 19:47:15.701493 | 954a12c5-b60b-4f2d-b726-00f4fe2df241 ==============================
[0m19:47:15.701493 [info ] [MainThread]: Running with dbt=1.7.7
[0m19:47:15.702133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:47:16.053381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6b310>]}
[0m19:47:16.138926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614b590>]}
[0m19:47:16.139719 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:47:16.161779 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m19:47:16.180819 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:47:16.181508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7d590>]}
[0m19:47:17.471818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071381d0>]}
[0m19:47:17.491472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071089d0>]}
[0m19:47:17.492076 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m19:47:17.492502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d2cd0>]}
[0m19:47:17.494730 [info ] [MainThread]: 
[0m19:47:17.495717 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:47:17.497365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m19:47:17.518925 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m19:47:17.519383 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m19:47:17.519724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:18.268449 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:47:18.270676 [debug] [ThreadPool]: On list_raw: Close
[0m19:47:18.359662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m19:47:18.369819 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m19:47:18.370280 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m19:47:18.370654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:18.800946 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m19:47:18.802694 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m19:47:18.939129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db4690>]}
[0m19:47:18.940344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:18.940968 [info ] [MainThread]: 
[0m19:47:18.944105 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m19:47:18.944876 [info ] [Thread-1 (]: 1 of 1 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m19:47:18.945829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m19:47:18.946280 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:47:18.957141 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:47:18.959094 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 19:47:18.946576 => 19:47:18.958752
[0m19:47:18.959661 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:47:19.014459 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m19:47:19.016523 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m19:47:19.017232 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_customers

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m19:47:19.017894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:19.631566 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b23483-0002-0af9-0000-0050d58710ed
[0m19:47:19.632232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m19:47:19.633006 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 19:47:18.959989 => 19:47:19.632681
[0m19:47:19.633597 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m19:47:19.734617 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m19:47:19.735361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '954a12c5-b60b-4f2d-b726-00f4fe2df241', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072994d0>]}
[0m19:47:19.736195 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model jaffle_shop.stg_customers ................. [[31mERROR[0m in 0.79s]
[0m19:47:19.737212 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:47:19.739848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:19.740286 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m19:47:19.740684 [info ] [MainThread]: 
[0m19:47:19.741108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m19:47:19.741858 [debug] [MainThread]: Command end result
[0m19:47:19.754579 [info ] [MainThread]: 
[0m19:47:19.755154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:47:19.755618 [info ] [MainThread]: 
[0m19:47:19.756329 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m19:47:19.756994 [info ] [MainThread]: 
[0m19:47:19.757736 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:47:19.760141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.114986, "process_user_time": 3.861428, "process_kernel_time": 0.302118, "process_mem_max_rss": "132333568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:47:19.761084 [debug] [MainThread]: Command `dbt run` failed at 19:47:19.760876 after 4.12 seconds
[0m19:47:19.761624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059457d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101519b10>]}
[0m19:47:19.762073 [debug] [MainThread]: Flushing usage events
[0m19:57:51.283959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e61bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a8750>]}


============================== 19:57:51.289434 | 91e4e9de-ba84-468f-9993-b0bc30dfc17b ==============================
[0m19:57:51.289434 [info ] [MainThread]: Running with dbt=1.7.7
[0m19:57:51.290318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_customers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:51.613425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91e4e9de-ba84-468f-9993-b0bc30dfc17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f821f50>]}
[0m19:57:51.700587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91e4e9de-ba84-468f-9993-b0bc30dfc17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edffdd0>]}
[0m19:57:51.701384 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:57:51.723463 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m19:57:51.761248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:51.761677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:51.768568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91e4e9de-ba84-468f-9993-b0bc30dfc17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa1d010>]}
[0m19:57:51.782752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91e4e9de-ba84-468f-9993-b0bc30dfc17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f91e850>]}
[0m19:57:51.783283 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m19:57:51.783733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e4e9de-ba84-468f-9993-b0bc30dfc17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f867250>]}
[0m19:57:51.785718 [info ] [MainThread]: 
[0m19:57:51.786614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:57:51.787788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m19:57:51.865359 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m19:57:51.865866 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m19:57:51.866232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:52.458537 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:57:52.461284 [debug] [ThreadPool]: On list_raw: Close
[0m19:57:52.551978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m19:57:52.566525 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m19:57:52.567139 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m19:57:52.567590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:53.192348 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m19:57:53.194473 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m19:57:53.286459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e4e9de-ba84-468f-9993-b0bc30dfc17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e687ad0>]}
[0m19:57:53.287749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:57:53.288376 [info ] [MainThread]: 
[0m19:57:53.291639 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m19:57:53.292390 [info ] [Thread-1 (]: 1 of 1 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m19:57:53.293233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m19:57:53.293681 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:57:53.303610 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:57:53.304524 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 19:57:53.293970 => 19:57:53.304272
[0m19:57:53.304937 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:57:53.338354 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m19:57:53.339517 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m19:57:53.339917 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_customers

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m19:57:53.340296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:53.809018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:57:53.831044 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 19:57:53.305186 => 19:57:53.830811
[0m19:57:53.831490 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m19:57:53.919231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e4e9de-ba84-468f-9993-b0bc30dfc17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd3410>]}
[0m19:57:53.920260 [info ] [Thread-1 (]: 1 of 1 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m19:57:53.921197 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:57:53.923919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:53.924450 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m19:57:53.924942 [info ] [MainThread]: 
[0m19:57:53.925460 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m19:57:53.926359 [debug] [MainThread]: Command end result
[0m19:57:53.940676 [info ] [MainThread]: 
[0m19:57:53.941172 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:57:53.941731 [info ] [MainThread]: 
[0m19:57:53.942744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:57:53.945112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.71284, "process_user_time": 2.665883, "process_kernel_time": 0.281434, "process_mem_max_rss": "124796928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:57:53.945823 [debug] [MainThread]: Command `dbt run` succeeded at 19:57:53.945677 after 2.71 seconds
[0m19:57:53.946272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f90b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a160f10>]}
[0m19:57:53.946847 [debug] [MainThread]: Flushing usage events
[0m20:14:53.459990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11445e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d8d10>]}


============================== 20:14:53.467408 | 6bb06eb5-51fe-4fb1-afd6-880bec3ee158 ==============================
[0m20:14:53.467408 [info ] [MainThread]: Running with dbt=1.7.7
[0m20:14:53.468984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:14:53.994815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cae090>]}
[0m20:14:54.082165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c17650>]}
[0m20:14:54.084658 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:14:54.110140 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m20:14:54.204834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:54.205347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:54.212145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115855110>]}
[0m20:14:54.228345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c46c90>]}
[0m20:14:54.228882 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:14:54.231925 [info ] [MainThread]: 
[0m20:14:54.232999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:14:54.234472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:14:54.310745 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:14:54.311227 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:14:54.311590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:55.122370 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:14:55.125319 [debug] [ThreadPool]: On list_raw: Close
[0m20:14:55.214079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m20:14:55.225205 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m20:14:55.225670 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m20:14:55.226079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:55.924200 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:14:55.927433 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m20:14:56.016335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137afc90>]}
[0m20:14:56.017486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:56.018057 [info ] [MainThread]: 
[0m20:14:56.022641 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:14:56.023225 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:14:56.023651 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:14:56.024226 [info ] [Thread-1 (]: 1 of 28 START seed file jaffle_shop.raw_customers .............................. [RUN]
[0m20:14:56.024819 [info ] [Thread-2 (]: 2 of 28 START seed file jaffle_shop.raw_orders ................................. [RUN]
[0m20:14:56.025402 [info ] [Thread-3 (]: 3 of 28 START seed file jaffle_shop.raw_payments ............................... [RUN]
[0m20:14:56.026527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now seed.jaffle_shop.raw_customers)
[0m20:14:56.028174 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m20:14:56.029914 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:14:56.030543 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:14:56.031272 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:14:56.031972 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:14:56.032891 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 20:14:56.032471 => 20:14:56.032479
[0m20:14:56.033810 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 20:14:56.033555 => 20:14:56.033558
[0m20:14:56.034729 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 20:14:56.034494 => 20:14:56.034497
[0m20:14:56.035134 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:14:56.035526 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:14:56.035926 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:14:56.091491 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:14:56.101092 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:14:56.101623 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:14:56.101995 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:14:56.102425 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.jaffle_shop.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:14:56.102808 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:14:56.103201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:56.103587 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:56.103943 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:14:56.559888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:56.560763 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:14:56.561444 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "RAW"."JAFFLE_SHOP"."RAW_CUSTOMERS"
  ;
[0m20:14:56.620684 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:56.621493 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:14:56.622160 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "RAW"."JAFFLE_SHOP"."RAW_ORDERS"
  ;
[0m20:14:56.656019 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:56.675740 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:14:56.676194 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:14:56.827207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:56.828130 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:56.828764 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:14:56.832909 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:14:56.833461 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:14:56.834013 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.jaffle_shop.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m20:14:56.870525 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:56.871329 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:14:56.871965 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:14:57.235796 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:57.237523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:57.242091 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:14:57.245876 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:14:57.246351 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:14:57.246793 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:14:57.379620 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:57.381152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:57.385158 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:14:57.388233 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:14:57.388791 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:14:57.389290 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:14:57.646993 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.0 seconds
[0m20:14:57.647893 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:14:57.648564 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:14:58.056741 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:58.058394 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.0 seconds
[0m20:14:58.065084 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.0 seconds
[0m20:14:58.067319 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:14:58.067902 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:14:58.068424 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:14:58.069069 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:14:58.069583 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:14:58.095977 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 20:14:56.077336 => 20:14:58.095385
[0m20:14:58.096781 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:14:58.182328 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c7e050>]}
[0m20:14:58.183489 [info ] [Thread-3 (]: 3 of 28 OK loaded seed file jaffle_shop.raw_payments ........................... [[32mINSERT 113[0m in 2.15s]
[0m20:14:58.184634 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:14:58.185869 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_payments
[0m20:14:58.186767 [info ] [Thread-4 (]: 4 of 28 START sql view model jaffle_shop.stg_payments .......................... [RUN]
[0m20:14:58.187915 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m20:14:58.188464 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:14:58.200355 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:14:58.201748 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.stg_payments (compile): 20:14:58.188814 => 20:14:58.201314
[0m20:14:58.202482 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:14:58.229598 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m20:14:58.231128 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m20:14:58.231729 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m20:14:58.232404 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:58.328779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:58.330101 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:58.331370 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:14:58.332443 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:14:58.336027 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 20:14:56.059923 => 20:14:58.335792
[0m20:14:58.338850 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 20:14:56.036239 => 20:14:58.338630
[0m20:14:58.339262 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:14:58.339810 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:14:58.442767 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11568cf10>]}
[0m20:14:58.443838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157ff650>]}
[0m20:14:58.444655 [info ] [Thread-2 (]: 2 of 28 OK loaded seed file jaffle_shop.raw_orders ............................. [[32mINSERT 99[0m in 2.42s]
[0m20:14:58.445532 [info ] [Thread-1 (]: 1 of 28 OK loaded seed file jaffle_shop.raw_customers .......................... [[32mINSERT 100[0m in 2.42s]
[0m20:14:58.446723 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:14:58.447815 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:14:58.448686 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m20:14:58.449364 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m20:14:58.449903 [info ] [Thread-3 (]: 5 of 28 START sql view model jaffle_shop.stg_orders ............................ [RUN]
[0m20:14:58.450479 [info ] [Thread-2 (]: 6 of 28 START sql view model jaffle_shop.stg_customers ......................... [RUN]
[0m20:14:58.451305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now model.jaffle_shop.stg_orders)
[0m20:14:58.452097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now model.jaffle_shop.stg_customers)
[0m20:14:58.452909 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:14:58.453565 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:14:58.458303 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:14:58.462045 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:14:58.462962 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 20:14:58.453899 => 20:14:58.462704
[0m20:14:58.463483 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (compile): 20:14:58.458730 => 20:14:58.463233
[0m20:14:58.463853 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:14:58.464425 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:14:58.469458 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:14:58.475927 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:14:58.479572 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m20:14:58.480537 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_orders

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m20:14:58.481420 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m20:14:58.482382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:58.483522 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_customers

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m20:14:58.485247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:58.655430 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:14:58.659397 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.stg_payments (execute): 20:14:58.203105 => 20:14:58.659088
[0m20:14:58.659951 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: Close
[0m20:14:58.866928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159c5990>]}
[0m20:14:58.869365 [info ] [Thread-4 (]: 4 of 28 OK created sql view model jaffle_shop.stg_payments ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m20:14:58.871938 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:14:58.873299 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:14:58.873763 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:14:58.874268 [info ] [Thread-1 (]: 7 of 28 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m20:14:58.874798 [info ] [Thread-4 (]: 8 of 28 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m20:14:58.875623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278)
[0m20:14:58.876792 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075)
[0m20:14:58.877330 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:14:58.878076 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:14:58.894166 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m20:14:58.904810 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m20:14:58.906584 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (compile): 20:14:58.894432 => 20:14:58.905879
[0m20:14:58.907434 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:14:58.908511 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (compile): 20:14:58.879008 => 20:14:58.907959
[0m20:14:58.925712 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m20:14:58.926179 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:14:58.929110 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m20:14:58.930460 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m20:14:58.931437 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m20:14:58.931811 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from raw.jaffle_shop.stg_payments
where payment_id is null



      
    ) dbt_internal_test
[0m20:14:58.932255 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from raw.jaffle_shop.stg_payments
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m20:14:58.932661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:58.933127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:59.017842 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:59.025894 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (execute): 20:14:58.469811 => 20:14:59.025559
[0m20:14:59.026503 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: Close
[0m20:14:59.063658 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:59.085215 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 20:14:58.464920 => 20:14:59.084889
[0m20:14:59.086328 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m20:14:59.134927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159ef710>]}
[0m20:14:59.135941 [info ] [Thread-2 (]: 6 of 28 OK created sql view model jaffle_shop.stg_customers .................... [[32mSUCCESS 1[0m in 0.68s]
[0m20:14:59.136906 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:14:59.137552 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:14:59.138539 [info ] [Thread-2 (]: 9 of 28 START test unique_stg_payments_payment_id .............................. [RUN]
[0m20:14:59.139616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m20:14:59.140184 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:14:59.151352 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m20:14:59.153446 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (compile): 20:14:59.140537 => 20:14:59.153151
[0m20:14:59.153976 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:14:59.157996 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m20:14:59.159751 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m20:14:59.160211 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.stg_payments
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:59.160602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:59.239211 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112142bd0>]}
[0m20:14:59.240521 [info ] [Thread-3 (]: 5 of 28 OK created sql view model jaffle_shop.stg_orders ....................... [[32mSUCCESS 1[0m in 0.79s]
[0m20:14:59.241587 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:14:59.242395 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:59.243690 [info ] [Thread-3 (]: 10 of 28 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m20:14:59.245336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:14:59.247238 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:59.252859 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:59.255174 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 20:14:59.247594 => 20:14:59.254175
[0m20:14:59.255967 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:59.259760 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:59.260877 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:59.261298 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from raw.jaffle_shop.stg_customers
where customer_id is null



      
    ) dbt_internal_test
[0m20:14:59.261680 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:59.443933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:59.450204 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (execute): 20:14:58.926589 => 20:14:59.449815
[0m20:14:59.450842 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m20:14:59.506475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:59.509619 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (execute): 20:14:58.908743 => 20:14:59.509284
[0m20:14:59.510193 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m20:14:59.549864 [info ] [Thread-1 (]: 7 of 28 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 0.67s]
[0m20:14:59.551033 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:14:59.551733 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:14:59.552594 [info ] [Thread-1 (]: 11 of 28 START test unique_stg_customers_customer_id ........................... [RUN]
[0m20:14:59.553635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m20:14:59.554332 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:14:59.559783 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:14:59.560761 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 20:14:59.554798 => 20:14:59.560473
[0m20:14:59.561218 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:14:59.566208 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:14:59.567685 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:14:59.568118 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:59.568505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:59.603837 [info ] [Thread-4 (]: 8 of 28 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.73s]
[0m20:14:59.604939 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:14:59.605731 [debug] [Thread-4 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:14:59.606529 [info ] [Thread-4 (]: 12 of 28 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m20:14:59.607697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m20:14:59.608373 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:14:59.622461 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:14:59.623799 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 20:14:59.608777 => 20:14:59.623359
[0m20:14:59.624461 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:14:59.630342 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:14:59.632676 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:14:59.633650 [debug] [Thread-4 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from raw.jaffle_shop.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m20:14:59.634519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:59.899752 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:59.904945 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (execute): 20:14:59.154304 => 20:14:59.904480
[0m20:14:59.905613 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m20:14:59.942601 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:59.945799 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 20:14:59.256441 => 20:14:59.945432
[0m20:14:59.946625 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m20:14:59.998706 [info ] [Thread-2 (]: 9 of 28 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.86s]
[0m20:15:00.000200 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:15:00.001051 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:00.001808 [info ] [Thread-2 (]: 13 of 28 START test not_null_stg_orders_order_id ............................... [RUN]
[0m20:15:00.003221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_payments_payment_id.3744510712, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:15:00.004508 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:00.012233 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:15:00.013663 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 20:15:00.005864 => 20:15:00.013125
[0m20:15:00.014388 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:00.022988 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:15:00.024187 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:15:00.024631 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from raw.jaffle_shop.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m20:15:00.025230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:00.053929 [info ] [Thread-3 (]: 10 of 28 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.81s]
[0m20:15:00.054793 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:00.055255 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:00.055885 [info ] [Thread-3 (]: 14 of 28 START test unique_stg_orders_order_id ................................. [RUN]
[0m20:15:00.056898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m20:15:00.057362 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:00.061781 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:15:00.062741 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 20:15:00.057636 => 20:15:00.062390
[0m20:15:00.063158 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:00.069072 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:15:00.070243 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:15:00.070675 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:00.071065 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:00.177527 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:15:00.180393 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 20:14:59.624891 => 20:15:00.180103
[0m20:15:00.181152 [debug] [Thread-4 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m20:15:00.288568 [info ] [Thread-4 (]: 12 of 28 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.68s]
[0m20:15:00.289615 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:15:00.356427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:15:00.359671 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 20:14:59.561512 => 20:15:00.359332
[0m20:15:00.360245 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m20:15:00.449316 [info ] [Thread-1 (]: 11 of 28 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.90s]
[0m20:15:00.450432 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:15:00.465556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:00.467867 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 20:15:00.063526 => 20:15:00.467603
[0m20:15:00.468297 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m20:15:00.502399 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:00.506248 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 20:15:00.014858 => 20:15:00.505883
[0m20:15:00.506996 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m20:15:00.559496 [info ] [Thread-3 (]: 14 of 28 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.50s]
[0m20:15:00.561064 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:00.611814 [info ] [Thread-2 (]: 13 of 28 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.61s]
[0m20:15:00.613063 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:00.614513 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m20:15:00.615083 [debug] [Thread-1 (]: Began running node model.jaffle_shop.orders
[0m20:15:00.615868 [info ] [Thread-4 (]: 15 of 28 START sql table model jaffle_shop.customers ........................... [RUN]
[0m20:15:00.616666 [info ] [Thread-1 (]: 16 of 28 START sql table model jaffle_shop.orders .............................. [RUN]
[0m20:15:00.617695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now model.jaffle_shop.customers)
[0m20:15:00.618562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now model.jaffle_shop.orders)
[0m20:15:00.619034 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m20:15:00.619484 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.orders
[0m20:15:00.623923 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:15:00.630017 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m20:15:00.631402 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 20:15:00.619798 => 20:15:00.630950
[0m20:15:00.632155 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.orders (compile): 20:15:00.624313 => 20:15:00.631771
[0m20:15:00.633140 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m20:15:00.633676 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.orders
[0m20:15:00.691072 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:15:00.697847 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m20:15:00.709488 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.orders"
[0m20:15:00.710357 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
create or replace transient table raw.jaffle_shop.orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m20:15:00.711111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:00.701899 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m20:15:00.714157 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace transient table raw.jaffle_shop.customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m20:15:00.714988 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:01.948055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:15:01.949581 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:15:01.953379 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.orders (execute): 20:15:00.657886 => 20:15:01.953070
[0m20:15:01.956795 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 20:15:00.633967 => 20:15:01.956515
[0m20:15:01.957264 [debug] [Thread-1 (]: On model.jaffle_shop.orders: Close
[0m20:15:01.957711 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m20:15:02.049051 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158cba10>]}
[0m20:15:02.050178 [info ] [Thread-4 (]: 15 of 28 OK created sql table model jaffle_shop.customers ...................... [[32mSUCCESS 1[0m in 1.43s]
[0m20:15:02.051102 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m20:15:02.051994 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:02.052609 [info ] [Thread-2 (]: 17 of 28 START test not_null_customers_customer_id ............................. [RUN]
[0m20:15:02.053271 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:02.054350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m20:15:02.054863 [info ] [Thread-3 (]: 18 of 28 START test unique_customers_customer_id ............................... [RUN]
[0m20:15:02.055531 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:02.056416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m20:15:02.063093 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:15:02.063684 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:02.068091 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:15:02.068989 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 20:15:02.056752 => 20:15:02.068729
[0m20:15:02.069450 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:02.069947 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 20:15:02.064163 => 20:15:02.069720
[0m20:15:02.072835 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:15:02.073857 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:02.079530 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:15:02.081406 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:15:02.082375 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from raw.jaffle_shop.customers
where customer_id is null



      
    ) dbt_internal_test
[0m20:15:02.083268 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:02.085036 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:15:02.088469 [debug] [Thread-3 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:02.089249 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:02.099447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb06eb5-51fe-4fb1-afd6-880bec3ee158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115779c90>]}
[0m20:15:02.100515 [info ] [Thread-1 (]: 16 of 28 OK created sql table model jaffle_shop.orders ......................... [[32mSUCCESS 1[0m in 1.48s]
[0m20:15:02.102931 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.orders
[0m20:15:02.104203 [debug] [Thread-4 (]: Began running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:02.104835 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:02.105543 [info ] [Thread-4 (]: 19 of 28 START test accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m20:15:02.106252 [info ] [Thread-1 (]: 20 of 28 START test not_null_orders_amount ..................................... [RUN]
[0m20:15:02.107286 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3)
[0m20:15:02.108209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.orders, now test.jaffle_shop.not_null_orders_amount.106140f9fd)
[0m20:15:02.108654 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:02.109041 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:02.113718 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m20:15:02.118193 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m20:15:02.119261 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_amount.106140f9fd (compile): 20:15:02.114087 => 20:15:02.118918
[0m20:15:02.119710 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3 (compile): 20:15:02.109297 => 20:15:02.119479
[0m20:15:02.120110 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:02.120512 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:02.124213 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m20:15:02.128143 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m20:15:02.130498 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m20:15:02.133148 [debug] [Thread-4 (]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from raw.jaffle_shop.orders
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m20:15:02.134708 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:02.135646 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m20:15:02.137152 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from raw.jaffle_shop.orders
where amount is null



      
    ) dbt_internal_test
[0m20:15:02.138167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:02.562626 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:02.563680 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:02.566590 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 20:15:02.070162 => 20:15:02.566243
[0m20:15:02.569066 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 20:15:02.074822 => 20:15:02.568735
[0m20:15:02.569655 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m20:15:02.570215 [debug] [Thread-3 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m20:15:02.586737 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:02.589799 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3 (execute): 20:15:02.124975 => 20:15:02.589457
[0m20:15:02.590381 [debug] [Thread-4 (]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: Close
[0m20:15:02.687368 [info ] [Thread-3 (]: 18 of 28 PASS unique_customers_customer_id ..................................... [[32mPASS[0m in 0.63s]
[0m20:15:02.688420 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:02.689055 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:02.689822 [info ] [Thread-3 (]: 21 of 28 START test not_null_orders_bank_transfer_amount ....................... [RUN]
[0m20:15:02.691385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1, now test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49)
[0m20:15:02.692001 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:02.697774 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m20:15:02.698925 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49 (compile): 20:15:02.692359 => 20:15:02.698438
[0m20:15:02.699981 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:02.705230 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m20:15:02.706475 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m20:15:02.706944 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select bank_transfer_amount
from raw.jaffle_shop.orders
where bank_transfer_amount is null



      
    ) dbt_internal_test
[0m20:15:02.707837 [info ] [Thread-4 (]: 19 of 28 PASS accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.60s]
[0m20:15:02.708261 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:02.709072 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:02.710831 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:02.711464 [info ] [Thread-4 (]: 22 of 28 START test not_null_orders_coupon_amount .............................. [RUN]
[0m20:15:02.712624 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3, now test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625)
[0m20:15:02.714106 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:02.720565 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m20:15:02.721688 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625 (compile): 20:15:02.714661 => 20:15:02.721363
[0m20:15:02.722115 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:02.726353 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m20:15:02.728387 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m20:15:02.728983 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select coupon_amount
from raw.jaffle_shop.orders
where coupon_amount is null



      
    ) dbt_internal_test
[0m20:15:02.729399 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:02.785867 [info ] [Thread-2 (]: 17 of 28 PASS not_null_customers_customer_id ................................... [[32mPASS[0m in 0.73s]
[0m20:15:02.786952 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:02.787663 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:02.788231 [info ] [Thread-2 (]: 23 of 28 START test not_null_orders_credit_card_amount ......................... [RUN]
[0m20:15:02.788990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59)
[0m20:15:02.789402 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:02.793819 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m20:15:02.794966 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59 (compile): 20:15:02.789660 => 20:15:02.794402
[0m20:15:02.795646 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:02.800595 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m20:15:02.802967 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m20:15:02.803856 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_card_amount
from raw.jaffle_shop.orders
where credit_card_amount is null



      
    ) dbt_internal_test
[0m20:15:02.804290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:02.851368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:15:02.863266 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_amount.106140f9fd (execute): 20:15:02.120787 => 20:15:02.862912
[0m20:15:02.864810 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: Close
[0m20:15:02.968873 [info ] [Thread-1 (]: 20 of 28 PASS not_null_orders_amount ........................................... [[32mPASS[0m in 0.86s]
[0m20:15:02.969837 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:02.970390 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:02.971034 [info ] [Thread-1 (]: 24 of 28 START test not_null_orders_customer_id ................................ [RUN]
[0m20:15:02.971865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_amount.106140f9fd, now test.jaffle_shop.not_null_orders_customer_id.c5f02694af)
[0m20:15:02.972295 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:02.976699 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m20:15:02.977592 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_customer_id.c5f02694af (compile): 20:15:02.972546 => 20:15:02.977292
[0m20:15:02.978004 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:02.982905 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m20:15:02.986048 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m20:15:02.986511 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from raw.jaffle_shop.orders
where customer_id is null



      
    ) dbt_internal_test
[0m20:15:02.987001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:03.153988 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:03.155043 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:03.157900 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59 (execute): 20:15:02.796052 => 20:15:03.157554
[0m20:15:03.160362 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49 (execute): 20:15:02.700404 => 20:15:03.160025
[0m20:15:03.160974 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: Close
[0m20:15:03.161547 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: Close
[0m20:15:03.166844 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:03.169715 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625 (execute): 20:15:02.722368 => 20:15:03.169418
[0m20:15:03.170485 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: Close
[0m20:15:03.262237 [info ] [Thread-2 (]: 23 of 28 PASS not_null_orders_credit_card_amount ............................... [[32mPASS[0m in 0.47s]
[0m20:15:03.263638 [info ] [Thread-4 (]: 22 of 28 PASS not_null_orders_coupon_amount .................................... [[32mPASS[0m in 0.55s]
[0m20:15:03.264860 [info ] [Thread-3 (]: 21 of 28 PASS not_null_orders_bank_transfer_amount ............................. [[32mPASS[0m in 0.57s]
[0m20:15:03.265953 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:03.266698 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:03.267372 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:03.267899 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:03.268455 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:03.269014 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:03.269526 [info ] [Thread-2 (]: 25 of 28 START test not_null_orders_gift_card_amount ........................... [RUN]
[0m20:15:03.270052 [info ] [Thread-4 (]: 26 of 28 START test not_null_orders_order_id ................................... [RUN]
[0m20:15:03.270580 [info ] [Thread-3 (]: 27 of 28 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m20:15:03.271402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59, now test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a)
[0m20:15:03.272144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625, now test.jaffle_shop.not_null_orders_order_id.cf6c17daed)
[0m20:15:03.273095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49, now test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2)
[0m20:15:03.273751 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:03.274204 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:03.274675 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:03.282124 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m20:15:03.286984 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m20:15:03.300057 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m20:15:03.301201 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a (compile): 20:15:03.275130 => 20:15:03.300933
[0m20:15:03.301611 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:03.304523 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m20:15:03.305041 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_order_id.cf6c17daed (compile): 20:15:03.282607 => 20:15:03.304784
[0m20:15:03.305495 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2 (compile): 20:15:03.287347 => 20:15:03.305276
[0m20:15:03.306083 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:03.306593 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:03.309379 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m20:15:03.310158 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m20:15:03.313805 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m20:15:03.314742 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gift_card_amount
from raw.jaffle_shop.orders
where gift_card_amount is null



      
    ) dbt_internal_test
[0m20:15:03.316612 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m20:15:03.317397 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:03.319045 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m20:15:03.319802 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from raw.jaffle_shop.orders
where order_id is null



      
    ) dbt_internal_test
[0m20:15:03.322008 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from raw.jaffle_shop.orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from raw.jaffle_shop.customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:15:03.322792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:15:03.323471 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:03.509394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:15:03.513710 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_customer_id.c5f02694af (execute): 20:15:02.978254 => 20:15:03.513450
[0m20:15:03.514208 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: Close
[0m20:15:03.639189 [info ] [Thread-1 (]: 24 of 28 PASS not_null_orders_customer_id ...................................... [[32mPASS[0m in 0.67s]
[0m20:15:03.640247 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:03.640873 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:03.641644 [info ] [Thread-1 (]: 28 of 28 START test unique_orders_order_id ..................................... [RUN]
[0m20:15:03.642744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_customer_id.c5f02694af, now test.jaffle_shop.unique_orders_order_id.fed79b3a6e)
[0m20:15:03.643326 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:03.649321 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m20:15:03.650362 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_orders_order_id.fed79b3a6e (compile): 20:15:03.643674 => 20:15:03.650060
[0m20:15:03.650827 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:03.657113 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m20:15:03.658268 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m20:15:03.658671 [debug] [Thread-1 (]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:03.659052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:03.759689 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:03.760687 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:03.763502 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_order_id.cf6c17daed (execute): 20:15:03.306893 => 20:15:03.763126
[0m20:15:03.766370 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a (execute): 20:15:03.301925 => 20:15:03.765888
[0m20:15:03.767122 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: Close
[0m20:15:03.767703 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: Close
[0m20:15:03.851008 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:15:03.853244 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2 (execute): 20:15:03.310380 => 20:15:03.852839
[0m20:15:03.853890 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m20:15:03.872565 [info ] [Thread-2 (]: 25 of 28 PASS not_null_orders_gift_card_amount ................................. [[32mPASS[0m in 0.60s]
[0m20:15:03.873968 [info ] [Thread-4 (]: 26 of 28 PASS not_null_orders_order_id ......................................... [[32mPASS[0m in 0.60s]
[0m20:15:03.875363 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:03.877382 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:03.947090 [info ] [Thread-3 (]: 27 of 28 PASS relationships_orders_customer_id__customer_id__ref_customers_ .... [[32mPASS[0m in 0.67s]
[0m20:15:03.948299 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:04.079111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:15:04.082240 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_orders_order_id.fed79b3a6e (execute): 20:15:03.651137 => 20:15:04.081906
[0m20:15:04.082802 [debug] [Thread-1 (]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: Close
[0m20:15:04.232706 [info ] [Thread-1 (]: 28 of 28 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 0.59s]
[0m20:15:04.233864 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:04.236752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:04.237271 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' was properly closed.
[0m20:15:04.237707 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a' was properly closed.
[0m20:15:04.238131 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2' was properly closed.
[0m20:15:04.238552 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_orders_order_id.cf6c17daed' was properly closed.
[0m20:15:04.239106 [info ] [MainThread]: 
[0m20:15:04.239593 [info ] [MainThread]: Finished running 3 seeds, 3 view models, 20 tests, 2 table models in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m20:15:04.244497 [debug] [MainThread]: Command end result
[0m20:15:04.260188 [info ] [MainThread]: 
[0m20:15:04.260802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:04.261308 [info ] [MainThread]: 
[0m20:15:04.261784 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m20:15:04.265321 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.875457, "process_user_time": 5.792435, "process_kernel_time": 0.791927, "process_mem_max_rss": "131874816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:15:04.266714 [debug] [MainThread]: Command `dbt build` succeeded at 20:15:04.266437 after 10.88 seconds
[0m20:15:04.267885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11318df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144bbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fefe110>]}
[0m20:15:04.269259 [debug] [MainThread]: Flushing usage events
[0m20:15:14.048955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ee390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a974690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a974a90>]}


============================== 20:15:14.055475 | 82ddcd9d-fece-4514-aece-a6d3d9ab1c57 ==============================
[0m20:15:14.055475 [info ] [MainThread]: Running with dbt=1.7.7
[0m20:15:14.056580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:15:14.545348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82ddcd9d-fece-4514-aece-a6d3d9ab1c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a5310>]}
[0m20:15:14.631425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82ddcd9d-fece-4514-aece-a6d3d9ab1c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b08a5d0>]}
[0m20:15:14.634127 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:15:14.657473 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m20:15:14.749038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:14.749548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:14.756492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82ddcd9d-fece-4514-aece-a6d3d9ab1c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd15e50>]}
[0m20:15:14.760517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ddcd9d-fece-4514-aece-a6d3d9ab1c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd23450>]}
[0m20:15:14.761037 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:15:14.761633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ddcd9d-fece-4514-aece-a6d3d9ab1c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbda5d0>]}
[0m20:15:14.764666 [info ] [MainThread]: 
[0m20:15:14.765599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:14.767083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_jaffle_shop'
[0m20:15:14.786331 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m20:15:14.786887 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m20:15:14.787439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:15.467981 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m20:15:15.471155 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m20:15:15.565523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ddcd9d-fece-4514-aece-a6d3d9ab1c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b058790>]}
[0m20:15:15.566632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:15:15.567197 [info ] [MainThread]: 
[0m20:15:15.571722 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:15:15.572199 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:15:15.572633 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:15:15.573493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now seed.jaffle_shop.raw_customers)
[0m20:15:15.574355 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m20:15:15.575886 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:15:15.576382 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:15:15.576962 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:15:15.577904 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:15:15.585724 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 20:15:15.578900 => 20:15:15.585253
[0m20:15:15.587444 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 20:15:15.586025 => 20:15:15.587215
[0m20:15:15.589230 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 20:15:15.587710 => 20:15:15.589003
[0m20:15:15.589642 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:15:15.590086 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:15:15.590854 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:15:15.591489 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 20:15:15.591234 => 20:15:15.591256
[0m20:15:15.591965 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 20:15:15.591747 => 20:15:15.591754
[0m20:15:15.592425 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 20:15:15.592211 => 20:15:15.592217
[0m20:15:15.593375 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:15:15.594347 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:15:15.595399 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:15:15.596763 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_customers
[0m20:15:15.598213 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m20:15:15.599908 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:15:15.600788 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m20:15:15.601483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now model.jaffle_shop.stg_orders)
[0m20:15:15.602156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now model.jaffle_shop.stg_payments)
[0m20:15:15.602551 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:15:15.602923 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:15:15.603288 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:15:15.606252 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:15:15.608831 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:15:15.612826 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:15:15.614020 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 20:15:15.606554 => 20:15:15.613708
[0m20:15:15.614770 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.stg_customers (compile): 20:15:15.603537 => 20:15:15.614292
[0m20:15:15.615318 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:15:15.615868 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_payments (compile): 20:15:15.609125 => 20:15:15.615618
[0m20:15:15.616216 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:15:15.616707 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 20:15:15.616482 => 20:15:15.616494
[0m20:15:15.617077 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:15:15.617567 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.stg_customers (execute): 20:15:15.617324 => 20:15:15.617331
[0m20:15:15.618469 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:15:15.618941 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_payments (execute): 20:15:15.618723 => 20:15:15.618730
[0m20:15:15.619841 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:15:15.620970 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:15:15.621339 [debug] [Thread-3 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:15:15.621687 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:15.622110 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:15.623137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m20:15:15.623502 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:15.624158 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:15:15.624963 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m20:15:15.625384 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:15:15.626041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:15:15.626426 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:15.626795 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:15.640560 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:15:15.641006 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:15.649540 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:15:15.655599 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:15:15.659794 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:15:15.660689 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 20:15:15.627042 => 20:15:15.660421
[0m20:15:15.661510 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 20:15:15.641275 => 20:15:15.661233
[0m20:15:15.661992 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 20:15:15.649871 => 20:15:15.661750
[0m20:15:15.662401 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:15:15.662886 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:15.663407 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 20:15:15.656049 => 20:15:15.663169
[0m20:15:15.663734 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:15.664229 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 20:15:15.664000 => 20:15:15.664009
[0m20:15:15.664701 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 20:15:15.664485 => 20:15:15.664492
[0m20:15:15.665074 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:15.665538 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 20:15:15.665323 => 20:15:15.665329
[0m20:15:15.666548 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:15:15.667468 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:15:15.667948 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 20:15:15.667729 => 20:15:15.667735
[0m20:15:15.669096 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:15:15.669586 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:15:15.670153 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customers
[0m20:15:15.671140 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:15:15.671587 [debug] [Thread-4 (]: Began running node model.jaffle_shop.orders
[0m20:15:15.672285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m20:15:15.672927 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now model.jaffle_shop.customers)
[0m20:15:15.673373 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:15:15.674018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.orders)
[0m20:15:15.674406 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:15:15.674782 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customers
[0m20:15:15.675426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278)
[0m20:15:15.675939 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.orders
[0m20:15:15.680419 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:15:15.683718 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:15:15.684174 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:15:15.688004 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m20:15:15.695407 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m20:15:15.696104 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 20:15:15.676271 => 20:15:15.695855
[0m20:15:15.696595 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.customers (compile): 20:15:15.680793 => 20:15:15.696362
[0m20:15:15.697316 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.orders (compile): 20:15:15.684444 => 20:15:15.697087
[0m20:15:15.697683 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:15:15.698122 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.customers
[0m20:15:15.698540 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (compile): 20:15:15.688566 => 20:15:15.698324
[0m20:15:15.698911 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.orders
[0m20:15:15.699375 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 20:15:15.699158 => 20:15:15.699166
[0m20:15:15.699955 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.customers (execute): 20:15:15.699728 => 20:15:15.699735
[0m20:15:15.700347 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:15:15.700811 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.orders (execute): 20:15:15.700601 => 20:15:15.700606
[0m20:15:15.701704 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:15:15.702561 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customers
[0m20:15:15.703035 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (execute): 20:15:15.702813 => 20:15:15.702818
[0m20:15:15.703869 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.orders
[0m20:15:15.704298 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:15.704782 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:15:15.705819 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m20:15:15.706251 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:15.707107 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075)
[0m20:15:15.707784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m20:15:15.708224 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:15.708891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.orders, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m20:15:15.709291 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:15.709667 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:15:15.710289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m20:15:15.710674 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:15.714948 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m20:15:15.718907 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m20:15:15.719356 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:15.724538 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:15:15.729058 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:15:15.729578 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (compile): 20:15:15.710923 => 20:15:15.729357
[0m20:15:15.730225 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (compile): 20:15:15.715256 => 20:15:15.729985
[0m20:15:15.730878 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 20:15:15.719619 => 20:15:15.730655
[0m20:15:15.731246 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:15.731749 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 20:15:15.725305 => 20:15:15.731534
[0m20:15:15.732068 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:15:15.732437 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:15.732899 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (execute): 20:15:15.732683 => 20:15:15.732690
[0m20:15:15.733268 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:15.733728 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (execute): 20:15:15.733515 => 20:15:15.733521
[0m20:15:15.734180 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 20:15:15.733969 => 20:15:15.733974
[0m20:15:15.735060 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m20:15:15.735628 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 20:15:15.735351 => 20:15:15.735359
[0m20:15:15.736666 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m20:15:15.737670 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:15:15.738150 [debug] [Thread-3 (]: Began running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:15.739095 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:15:15.739532 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:15.739988 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:15.740678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075, now test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3)
[0m20:15:15.741408 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:15.742129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_payments_payment_id.3744510712, now test.jaffle_shop.not_null_orders_amount.106140f9fd)
[0m20:15:15.742774 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49)
[0m20:15:15.743174 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:15.743790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1, now test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625)
[0m20:15:15.744171 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:15.744540 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:15.748937 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m20:15:15.749370 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:15.753524 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m20:15:15.757611 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m20:15:15.761719 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m20:15:15.762509 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3 (compile): 20:15:15.744788 => 20:15:15.762184
[0m20:15:15.763253 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_amount.106140f9fd (compile): 20:15:15.749678 => 20:15:15.762967
[0m20:15:15.763694 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49 (compile): 20:15:15.753926 => 20:15:15.763471
[0m20:15:15.764272 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:15.764707 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:15.765092 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:15.765570 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625 (compile): 20:15:15.758041 => 20:15:15.765336
[0m20:15:15.765988 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3 (execute): 20:15:15.765772 => 20:15:15.765779
[0m20:15:15.766455 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_amount.106140f9fd (execute): 20:15:15.766240 => 20:15:15.766246
[0m20:15:15.766918 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49 (execute): 20:15:15.766704 => 20:15:15.766709
[0m20:15:15.767289 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:15.768210 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m20:15:15.769413 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m20:15:15.770892 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m20:15:15.771750 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625 (execute): 20:15:15.771358 => 20:15:15.771368
[0m20:15:15.772554 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:15.773317 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:15.774101 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:15.775709 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m20:15:15.776854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3, now test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59)
[0m20:15:15.780340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_amount.106140f9fd, now test.jaffle_shop.not_null_orders_customer_id.c5f02694af)
[0m20:15:15.781594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49, now test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a)
[0m20:15:15.782388 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:15.783063 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:15.783588 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:15.784238 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:15.785326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625, now test.jaffle_shop.not_null_orders_order_id.cf6c17daed)
[0m20:15:15.791720 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m20:15:15.796233 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m20:15:15.800460 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m20:15:15.800931 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:15.801858 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59 (compile): 20:15:15.785763 => 20:15:15.801603
[0m20:15:15.806598 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m20:15:15.807155 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_customer_id.c5f02694af (compile): 20:15:15.792054 => 20:15:15.806889
[0m20:15:15.807632 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:15.808234 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a (compile): 20:15:15.796588 => 20:15:15.807925
[0m20:15:15.808759 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:15.809283 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59 (execute): 20:15:15.809053 => 20:15:15.809062
[0m20:15:15.809679 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:15.810158 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_order_id.cf6c17daed (compile): 20:15:15.802162 => 20:15:15.809925
[0m20:15:15.810567 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_orders_customer_id.c5f02694af (execute): 20:15:15.810360 => 20:15:15.810365
[0m20:15:15.811472 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m20:15:15.812079 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a (execute): 20:15:15.811752 => 20:15:15.811758
[0m20:15:15.812643 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:15.813983 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m20:15:15.814830 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:15.816485 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m20:15:15.817359 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_orders_order_id.cf6c17daed (execute): 20:15:15.816976 => 20:15:15.816987
[0m20:15:15.818105 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:15.819277 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59, now test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2)
[0m20:15:15.821008 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:15:15.822153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_customer_id.c5f02694af, now test.jaffle_shop.unique_orders_order_id.fed79b3a6e)
[0m20:15:15.822862 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:15.823701 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:15.836321 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m20:15:15.841909 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m20:15:15.842782 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2 (compile): 20:15:15.824128 => 20:15:15.842532
[0m20:15:15.843208 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:15.843707 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_orders_order_id.fed79b3a6e (compile): 20:15:15.836643 => 20:15:15.843474
[0m20:15:15.844121 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2 (execute): 20:15:15.843908 => 20:15:15.843914
[0m20:15:15.844497 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:15.845399 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m20:15:15.845864 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_orders_order_id.fed79b3a6e (execute): 20:15:15.845652 => 20:15:15.845658
[0m20:15:15.846818 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:15:15.847992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:15.848326 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_orders_order_id.cf6c17daed' was properly closed.
[0m20:15:15.848631 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' was properly closed.
[0m20:15:15.848930 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2' was properly closed.
[0m20:15:15.849228 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a' was properly closed.
[0m20:15:15.853117 [debug] [MainThread]: Command end result
[0m20:15:15.875252 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:15:15.876062 [info ] [MainThread]: Building catalog
[0m20:15:15.881457 [debug] [ThreadPool]: Acquiring new snowflake connection 'raw.information_schema'
[0m20:15:15.906046 [debug] [ThreadPool]: Using snowflake connection "raw.information_schema"
[0m20:15:15.907145 [debug] [ThreadPool]: On raw.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "raw.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from raw.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_customers')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from raw.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_customers')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:15:15.908215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:18.948994 [debug] [ThreadPool]: SQL status: SUCCESS 39 in 3.0 seconds
[0m20:15:18.962051 [debug] [ThreadPool]: On raw.information_schema: Close
[0m20:15:19.102407 [info ] [MainThread]: Catalog written to /Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/target/catalog.json
[0m20:15:19.105807 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.141618, "process_user_time": 3.253472, "process_kernel_time": 0.514831, "process_mem_max_rss": "126455808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:15:19.106995 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:15:19.106777 after 5.14 seconds
[0m20:15:19.107703 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:15:19.108161 [debug] [MainThread]: Connection 'raw.information_schema' was properly closed.
[0m20:15:19.108557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1d2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b7450>]}
[0m20:15:19.109012 [debug] [MainThread]: Flushing usage events
[0m20:15:28.659342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae84750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b553fd0>]}


============================== 20:15:28.663802 | 2187032d-e25c-4f3f-9a8f-521c6600265a ==============================
[0m20:15:28.663802 [info ] [MainThread]: Running with dbt=1.7.7
[0m20:15:28.664467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:15:28.986278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2187032d-e25c-4f3f-9a8f-521c6600265a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcd6a10>]}
[0m20:15:29.076537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2187032d-e25c-4f3f-9a8f-521c6600265a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccbc90>]}
[0m14:00:31.214552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dc4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dcddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ddfd10>]}


============================== 14:00:31.222443 | 72acf82e-1218-4216-8646-7faee6d50ef1 ==============================
[0m14:00:31.222443 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:00:31.223557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:00:31.771313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72acf82e-1218-4216-8646-7faee6d50ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dcea90>]}
[0m14:00:31.858765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72acf82e-1218-4216-8646-7faee6d50ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11468b9d0>]}
[0m14:00:31.861648 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:00:31.885502 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:00:31.984305 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:00:31.985091 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/dim_customers.sql
[0m14:00:31.985542 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/customers.sql
[0m14:00:32.273831 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models/schema.yml'
[0m14:00:32.366657 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m14:00:32.367203 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m14:00:32.384603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72acf82e-1218-4216-8646-7faee6d50ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152f0bd0>]}
[0m14:00:32.396201 [error] [MainThread]: Encountered an error:
Compilation Error
  'test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2' depends on 'model.jaffle_shop.customers' which is not in the graph!
[0m14:00:32.399322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2543981, "process_user_time": 3.050375, "process_kernel_time": 0.624371, "process_mem_max_rss": "121245696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:00:32.400207 [debug] [MainThread]: Command `dbt run` failed at 14:00:32.400045 after 1.26 seconds
[0m14:00:32.400691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d79710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dc5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f981cd0>]}
[0m14:00:32.401336 [debug] [MainThread]: Flushing usage events
[0m14:07:25.818121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da537d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da45010>]}


============================== 14:07:25.825873 | 54fff89b-d55a-4547-946c-9fa9da9f7fdb ==============================
[0m14:07:25.825873 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:07:25.826980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:26.338041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec103d0>]}
[0m14:07:26.426854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d4350>]}
[0m14:07:26.428396 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:07:26.454355 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:07:26.541107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:26.542322 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m14:07:26.825444 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_orders' in the 'models' section of file 'models/schema.yml'
[0m14:07:26.958891 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_dim_orders_order_id.9786299635' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.959472 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_order_id.a67b7c295d' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.959902 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_customer_id.23bcdc00e5' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.960407 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_dim_orders_customer_id__customer_id__ref_customers_.2cd0bad1eb' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m14:07:26.960981 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_dim_orders_customer_id__customer_id__ref_customers_.2cd0bad1eb' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.961442 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.accepted_values_dim_orders_status__placed__shipped__completed__return_pending__returned.304a15493f' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.961880 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_amount.e1f1471120' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.962263 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_credit_card_amount.4b0e972055' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.962781 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_coupon_amount.dee365f98b' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.969240 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_bank_transfer_amount.55cfbaadc0' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.970508 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_gift_card_amount.eb308a6f43' (models/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m14:07:26.986543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef63cd0>]}
[0m14:07:27.004360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edf8350>]}
[0m14:07:27.005268 [info ] [MainThread]: Found 5 models, 3 seeds, 10 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:07:27.006513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef7b310>]}
[0m14:07:27.009270 [info ] [MainThread]: 
[0m14:07:27.010293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:27.011595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m14:07:27.029900 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m14:07:27.030371 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m14:07:27.030709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:28.489257 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:07:28.491926 [debug] [ThreadPool]: On list_raw: Close
[0m14:07:28.628400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m14:07:28.638643 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m14:07:28.639112 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m14:07:28.639485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:29.508972 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:07:29.511852 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m14:07:29.623474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f03e090>]}
[0m14:07:29.624635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:07:29.625363 [info ] [MainThread]: 
[0m14:07:29.629929 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:07:29.630410 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m14:07:29.630845 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:07:29.631441 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m14:07:29.632030 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m14:07:29.635551 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:07:29.636049 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:07:29.632615 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m14:07:29.634143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m14:07:29.648070 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:07:29.648932 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m14:07:29.649684 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:07:29.650825 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:07:29.653793 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:07:29.657527 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:07:29.658320 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 14:07:29.636322 => 14:07:29.658017
[0m14:07:29.660227 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:07:29.667105 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 14:07:29.651178 => 14:07:29.666599
[0m14:07:29.667823 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:07:29.668429 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 14:07:29.654325 => 14:07:29.668140
[0m14:07:29.717904 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:07:29.718632 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:07:29.719066 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:07:29.723507 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:07:29.725420 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:07:29.726646 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_orders

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m14:07:29.727820 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:07:29.728322 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:07:29.728843 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_customers

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m14:07:29.729663 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:07:29.732142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:29.732947 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m14:07:29.735322 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:07:30.531530 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:07:30.532449 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:07:30.533645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:07:30.569719 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 14:07:29.661285 => 14:07:30.569476
[0m14:07:30.570459 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 14:07:29.719644 => 14:07:30.570246
[0m14:07:30.574113 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 14:07:29.699459 => 14:07:30.573442
[0m14:07:30.575790 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m14:07:30.576581 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:07:30.577553 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:07:30.674309 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f21a0d0>]}
[0m14:07:30.675461 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f113f50>]}
[0m14:07:30.676395 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 1.03s]
[0m14:07:30.677274 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 1.04s]
[0m14:07:30.678473 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:07:30.679408 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:07:30.680646 [debug] [Thread-4 (]: Began running node model.jaffle_shop.orders
[0m14:07:30.681488 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.orders ................................ [RUN]
[0m14:07:30.682556 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.orders'
[0m14:07:30.683000 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.orders
[0m14:07:30.691269 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m14:07:30.694265 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.orders (compile): 14:07:30.683281 => 14:07:30.693825
[0m14:07:30.694845 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.orders
[0m14:07:30.721396 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m14:07:30.724434 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.orders"
[0m14:07:30.725343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edfa8d0>]}
[0m14:07:30.725896 [debug] [Thread-4 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */
create or replace transient table raw.jaffle_shop.orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m14:07:30.727305 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:07:30.726753 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m14:07:30.729912 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:07:30.731063 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m14:07:30.731822 [info ] [Thread-2 (]: 5 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m14:07:30.733751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.dim_customers)
[0m14:07:30.734463 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m14:07:30.739203 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m14:07:30.740263 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (compile): 14:07:30.734931 => 14:07:30.739934
[0m14:07:30.740824 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m14:07:30.745898 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m14:07:30.748456 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m14:07:30.748996 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m14:07:30.749523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:32.786428 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:07:32.790660 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.orders (execute): 14:07:30.695150 => 14:07:32.790346
[0m14:07:32.791226 [debug] [Thread-4 (]: On model.jaffle_shop.orders: Close
[0m14:07:32.815128 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:07:32.819467 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (execute): 14:07:30.741116 => 14:07:32.819148
[0m14:07:32.820059 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: Close
[0m14:07:32.920888 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f183850>]}
[0m14:07:32.923232 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fff89b-d55a-4547-946c-9fa9da9f7fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f113f50>]}
[0m14:07:32.924377 [info ] [Thread-2 (]: 5 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 2.19s]
[0m14:07:32.925322 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.orders ........................... [[32mSUCCESS 1[0m in 2.24s]
[0m14:07:32.926191 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m14:07:32.926853 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.orders
[0m14:07:32.929299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:32.929714 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m14:07:32.930065 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m14:07:32.930446 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:07:32.930848 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m14:07:32.931404 [info ] [MainThread]: 
[0m14:07:32.931896 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m14:07:32.933412 [debug] [MainThread]: Command end result
[0m14:07:32.947407 [info ] [MainThread]: 
[0m14:07:32.947891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:32.948259 [info ] [MainThread]: 
[0m14:07:32.948668 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:07:32.953207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2070365, "process_user_time": 3.920651, "process_kernel_time": 0.58123, "process_mem_max_rss": "131657728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:32.954159 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:32.954016 after 7.21 seconds
[0m14:07:32.954826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3840d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da74690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da74510>]}
[0m14:07:32.956267 [debug] [MainThread]: Flushing usage events
[0m14:08:03.849259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122b8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123137d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123345d0>]}


============================== 14:08:03.853885 | 75df0bfe-9fc3-4426-9079-3e86e446cb2e ==============================
[0m14:08:03.853885 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:08:03.854563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:04.206941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa4450>]}
[0m14:08:04.294552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112acfe10>]}
[0m14:08:04.297358 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:08:04.319893 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:08:04.412464 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:08:04.413170 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/dim_orders.sql
[0m14:08:04.413552 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/orders.sql
[0m14:08:04.618780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135f4050>]}
[0m14:08:04.633334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113593550>]}
[0m14:08:04.634143 [info ] [MainThread]: Found 5 models, 3 seeds, 10 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:08:04.634829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f660b10>]}
[0m14:08:04.637862 [info ] [MainThread]: 
[0m14:08:04.640565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:08:04.642746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m14:08:04.660645 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m14:08:04.661148 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m14:08:04.661500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:05.295680 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:08:05.298543 [debug] [ThreadPool]: On list_raw: Close
[0m14:08:05.398565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m14:08:05.408762 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m14:08:05.409367 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m14:08:05.409792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:05.864026 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:08:05.866303 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m14:08:06.011101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113467b50>]}
[0m14:08:06.012311 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:06.012893 [info ] [MainThread]: 
[0m14:08:06.018509 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:08:06.019001 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m14:08:06.019447 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:08:06.020068 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m14:08:06.020686 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m14:08:06.021275 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m14:08:06.022217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m14:08:06.023346 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:08:06.025024 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m14:08:06.026673 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:08:06.027196 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:08:06.028045 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:08:06.037529 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:08:06.043337 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:08:06.046547 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:08:06.048036 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 14:08:06.038165 => 14:08:06.047635
[0m14:08:06.048629 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 14:08:06.028559 => 14:08:06.048316
[0m14:08:06.049382 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 14:08:06.043824 => 14:08:06.048871
[0m14:08:06.050675 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:08:06.051502 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:08:06.052449 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:08:06.090676 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:08:06.097284 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:08:06.103390 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:08:06.104845 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:08:06.105809 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:08:06.106479 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_orders

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m14:08:06.107084 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_customers

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m14:08:06.107882 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:08:06.108360 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:06.108754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:06.109191 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m14:08:06.111660 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:08:06.612391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:08:06.638165 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 14:08:06.081503 => 14:08:06.637926
[0m14:08:06.638637 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:08:06.728477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136fc210>]}
[0m14:08:06.729524 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m14:08:06.730468 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:08:06.814832 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:08:06.816401 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:08:06.820446 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 14:08:06.097692 => 14:08:06.820128
[0m14:08:06.824139 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 14:08:06.052819 => 14:08:06.823874
[0m14:08:06.824634 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:08:06.825094 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m14:08:06.923232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113962c90>]}
[0m14:08:06.924165 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m14:08:06.925214 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:08:07.492283 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a2ef90>]}
[0m14:08:07.493199 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 1.47s]
[0m14:08:07.494332 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:08:07.495792 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m14:08:07.496705 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_orders
[0m14:08:07.497714 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m14:08:07.498466 [info ] [Thread-1 (]: 5 of 5 START sql table model jaffle_shop.dim_orders ............................ [RUN]
[0m14:08:07.499418 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.dim_customers'
[0m14:08:07.500188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.dim_orders)
[0m14:08:07.500671 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m14:08:07.501155 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_orders
[0m14:08:07.507442 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m14:08:07.511744 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_orders"
[0m14:08:07.512894 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_orders (compile): 14:08:07.507980 => 14:08:07.512608
[0m14:08:07.513580 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 14:08:07.501490 => 14:08:07.513151
[0m14:08:07.515177 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_orders
[0m14:08:07.515753 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m14:08:07.543006 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_orders"
[0m14:08:07.546021 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m14:08:07.548229 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.dim_orders"
[0m14:08:07.550232 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m14:08:07.550780 [debug] [Thread-1 (]: On model.jaffle_shop.dim_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_orders"} */
create or replace transient table raw.jaffle_shop.dim_orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m14:08:07.551380 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m14:08:07.552087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:07.552945 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:08:10.062603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m14:08:10.063757 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m14:08:10.067302 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_orders (execute): 14:08:07.516103 => 14:08:10.066981
[0m14:08:10.071068 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 14:08:07.543289 => 14:08:10.070812
[0m14:08:10.071669 [debug] [Thread-1 (]: On model.jaffle_shop.dim_orders: Close
[0m14:08:10.072366 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m14:08:10.162942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136ab310>]}
[0m14:08:10.163906 [info ] [Thread-1 (]: 5 of 5 OK created sql table model jaffle_shop.dim_orders ....................... [[32mSUCCESS 1[0m in 2.66s]
[0m14:08:10.164842 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_orders
[0m14:08:10.192901 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75df0bfe-9fc3-4426-9079-3e86e446cb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113993710>]}
[0m14:08:10.193909 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 2.69s]
[0m14:08:10.195046 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m14:08:10.197892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:10.198527 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_orders' was properly closed.
[0m14:08:10.198915 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:08:10.199532 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:08:10.200023 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m14:08:10.200917 [info ] [MainThread]: 
[0m14:08:10.202100 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m14:08:10.203870 [debug] [MainThread]: Command end result
[0m14:08:10.219637 [info ] [MainThread]: 
[0m14:08:10.221251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:10.221868 [info ] [MainThread]: 
[0m14:08:10.222346 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:08:10.225153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4309525, "process_user_time": 3.54817, "process_kernel_time": 0.498361, "process_mem_max_rss": "129384448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:10.225977 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:10.225757 after 6.43 seconds
[0m14:08:10.226573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112336410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd2e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddef550>]}
[0m14:08:10.227019 [debug] [MainThread]: Flushing usage events
[0m16:31:38.623325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b856750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b89ffd0>]}


============================== 16:31:38.630299 | c82976e2-f641-478f-9468-a27df09c0c51 ==============================
[0m16:31:38.630299 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:31:38.631159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:31:39.157545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c82976e2-f641-478f-9468-a27df09c0c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c068150>]}
[0m16:31:39.247711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c82976e2-f641-478f-9468-a27df09c0c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca7d490>]}
[0m16:31:39.250238 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:31:39.277296 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:31:39.345441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:39.345912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:39.352732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c82976e2-f641-478f-9468-a27df09c0c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f1d50>]}
[0m16:31:39.366358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c82976e2-f641-478f-9468-a27df09c0c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cadb790>]}
[0m16:31:39.366865 [info ] [MainThread]: Found 5 models, 3 seeds, 10 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:31:39.367349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c82976e2-f641-478f-9468-a27df09c0c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf81d0>]}
[0m16:31:39.369248 [info ] [MainThread]: 
[0m16:31:39.370202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:39.371346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m16:31:39.389936 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m16:31:39.391538 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m16:31:39.392098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:40.075828 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:31:40.078730 [debug] [ThreadPool]: On list_raw: Close
[0m16:31:40.182297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m16:31:40.192187 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m16:31:40.192786 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m16:31:40.193300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:40.927972 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m16:31:40.930959 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m16:31:41.030190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c82976e2-f641-478f-9468-a27df09c0c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb671d0>]}
[0m16:31:41.031361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:41.032070 [info ] [MainThread]: 
[0m16:31:41.036435 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m16:31:41.037069 [info ] [Thread-1 (]: 1 of 1 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m16:31:41.037920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.dim_customers)
[0m16:31:41.038394 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m16:31:41.052066 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m16:31:41.053733 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_customers (compile): 16:31:41.038692 => 16:31:41.053294
[0m16:31:41.054935 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m16:31:41.094739 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m16:31:41.097113 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m16:31:41.097578 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m16:31:41.098017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:43.033890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:31:43.059660 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_customers (execute): 16:31:41.056130 => 16:31:43.059424
[0m16:31:43.060131 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m16:31:43.160667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c82976e2-f641-478f-9468-a27df09c0c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca708d0>]}
[0m16:31:43.161619 [info ] [Thread-1 (]: 1 of 1 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 2.12s]
[0m16:31:43.162611 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m16:31:43.165264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:43.165916 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m16:31:43.166491 [info ] [MainThread]: 
[0m16:31:43.167015 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m16:31:43.167855 [debug] [MainThread]: Command end result
[0m16:31:43.181751 [info ] [MainThread]: 
[0m16:31:43.182341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:43.182735 [info ] [MainThread]: 
[0m16:31:43.183113 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:31:43.185711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.632737, "process_user_time": 3.157559, "process_kernel_time": 0.601118, "process_mem_max_rss": "125304832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:31:43.186371 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:43.186235 after 4.63 seconds
[0m16:31:43.186796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b89fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072da150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107441c90>]}
[0m16:31:43.187205 [debug] [MainThread]: Flushing usage events
[0m16:32:25.644810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f0750>]}


============================== 16:32:25.652597 | 37cc0ab4-c61b-43d7-839d-36674b8f6dc7 ==============================
[0m16:32:25.652597 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:32:25.653507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:32:26.138943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b23fd0>]}
[0m16:32:26.228533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108147e90>]}
[0m16:32:26.231039 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:32:26.256059 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:32:26.348160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:26.348680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:26.355465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107985cd0>]}
[0m16:32:26.368829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb5950>]}
[0m16:32:26.369415 [info ] [MainThread]: Found 5 models, 3 seeds, 10 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:32:26.369894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8cc50>]}
[0m16:32:26.372223 [info ] [MainThread]: 
[0m16:32:26.373215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:26.374686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m16:32:26.394842 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m16:32:26.395326 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m16:32:26.395670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:27.047614 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:32:27.050517 [debug] [ThreadPool]: On list_raw: Close
[0m16:32:27.203149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m16:32:27.214000 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m16:32:27.214468 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m16:32:27.214841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:27.784855 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m16:32:27.787000 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m16:32:27.883736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b69ed0>]}
[0m16:32:27.884963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:27.885523 [info ] [MainThread]: 
[0m16:32:27.890033 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m16:32:27.890519 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m16:32:27.890950 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m16:32:27.891555 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m16:32:27.892154 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m16:32:27.892739 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m16:32:27.893645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m16:32:27.894533 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m16:32:27.895622 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m16:32:27.896883 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m16:32:27.898322 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m16:32:27.899159 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m16:32:27.910372 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m16:32:27.913174 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m16:32:27.915884 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m16:32:27.917760 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 16:32:27.899892 => 16:32:27.917437
[0m16:32:27.918313 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 16:32:27.910765 => 16:32:27.918007
[0m16:32:27.918801 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 16:32:27.913497 => 16:32:27.918538
[0m16:32:27.919216 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m16:32:27.919923 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m16:32:27.920391 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m16:32:27.964202 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m16:32:27.964799 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m16:32:27.968284 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m16:32:27.969848 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m16:32:27.970743 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m16:32:27.971118 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_orders

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m16:32:27.971848 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m16:32:27.972258 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_customers

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m16:32:27.972771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:32:27.973284 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m16:32:27.973746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:27.974818 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:32:28.907965 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:32:28.909406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:32:28.910536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:32:28.947403 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 16:32:27.944975 => 16:32:28.947156
[0m16:32:28.951291 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 16:32:27.920733 => 16:32:28.951055
[0m16:32:28.954238 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 16:32:27.965090 => 16:32:28.953997
[0m16:32:28.954769 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m16:32:28.955224 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m16:32:28.955625 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m16:32:29.065479 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee88d0>]}
[0m16:32:29.066450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec1c10>]}
[0m16:32:29.067222 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 1.17s]
[0m16:32:29.068037 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 1.17s]
[0m16:32:29.068894 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m16:32:29.069745 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m16:32:29.089682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da28d0>]}
[0m16:32:29.090394 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 1.20s]
[0m16:32:29.091160 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m16:32:29.091978 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m16:32:29.092514 [debug] [Thread-3 (]: Began running node model.jaffle_shop.dim_orders
[0m16:32:29.093024 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m16:32:29.093609 [info ] [Thread-3 (]: 5 of 5 START sql table model jaffle_shop.dim_orders ............................ [RUN]
[0m16:32:29.094573 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.dim_customers'
[0m16:32:29.095278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.dim_orders)
[0m16:32:29.095742 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m16:32:29.096161 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.dim_orders
[0m16:32:29.101802 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m16:32:29.106304 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.dim_orders"
[0m16:32:29.108012 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 16:32:29.096517 => 16:32:29.107517
[0m16:32:29.108866 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.dim_orders (compile): 16:32:29.102177 => 16:32:29.108590
[0m16:32:29.109251 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m16:32:29.109632 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.dim_orders
[0m16:32:29.133067 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m16:32:29.136393 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.dim_orders"
[0m16:32:29.139160 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m16:32:29.139926 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m16:32:29.141734 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.dim_orders"
[0m16:32:29.142070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:32:29.142511 [debug] [Thread-3 (]: On model.jaffle_shop.dim_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_orders"} */
create or replace transient table raw.jaffle_shop.dim_orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m16:32:29.143591 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:32:30.750372 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:32:30.757045 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 16:32:29.109879 => 16:32:30.756545
[0m16:32:30.757914 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m16:32:30.852707 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce0d10>]}
[0m16:32:30.853561 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 1.76s]
[0m16:32:30.854317 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m16:32:31.200876 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:32:31.205174 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.dim_orders (execute): 16:32:29.133405 => 16:32:31.204860
[0m16:32:31.205744 [debug] [Thread-3 (]: On model.jaffle_shop.dim_orders: Close
[0m16:32:31.332579 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37cc0ab4-c61b-43d7-839d-36674b8f6dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818a010>]}
[0m16:32:31.333826 [info ] [Thread-3 (]: 5 of 5 OK created sql table model jaffle_shop.dim_orders ....................... [[32mSUCCESS 1[0m in 2.24s]
[0m16:32:31.334817 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.dim_orders
[0m16:32:31.337605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:31.338125 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m16:32:31.338557 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m16:32:31.338973 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_orders' was properly closed.
[0m16:32:31.339386 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m16:32:31.339874 [info ] [MainThread]: 
[0m16:32:31.340300 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m16:32:31.341668 [debug] [MainThread]: Command end result
[0m16:32:31.357411 [info ] [MainThread]: 
[0m16:32:31.358252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:31.359706 [info ] [MainThread]: 
[0m16:32:31.360342 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:32:31.363185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7829185, "process_user_time": 3.498427, "process_kernel_time": 0.542946, "process_mem_max_rss": "125976576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:32:31.363828 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:31.363693 after 5.78 seconds
[0m16:32:31.364290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033d6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10353dc50>]}
[0m16:32:31.364690 [debug] [MainThread]: Flushing usage events
[0m16:33:12.533725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e1ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f3d10>]}


============================== 16:33:12.540940 | 8a55654b-ea33-4176-aa4b-1c0df7948f01 ==============================
[0m16:33:12.540940 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:33:12.541909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:13.026010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a55654b-ea33-4176-aa4b-1c0df7948f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105881d90>]}
[0m16:33:13.113067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a55654b-ea33-4176-aa4b-1c0df7948f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105114ad0>]}
[0m16:33:13.115613 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:33:13.140129 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:33:13.236580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:33:13.237434 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/dim_customers.sql
[0m16:33:13.579267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a55654b-ea33-4176-aa4b-1c0df7948f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ac510>]}
[0m16:33:13.592318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a55654b-ea33-4176-aa4b-1c0df7948f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064dc990>]}
[0m16:33:13.592828 [info ] [MainThread]: Found 5 models, 3 seeds, 10 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:33:13.593641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a55654b-ea33-4176-aa4b-1c0df7948f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637c990>]}
[0m16:33:13.595333 [info ] [MainThread]: 
[0m16:33:13.596194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:13.597235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m16:33:13.615785 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m16:33:13.616260 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m16:33:13.616775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:14.267805 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:33:14.270751 [debug] [ThreadPool]: On list_raw: Close
[0m16:33:14.379911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m16:33:14.390892 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m16:33:14.391368 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m16:33:14.391743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:14.859774 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m16:33:14.861820 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m16:33:14.952699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a55654b-ea33-4176-aa4b-1c0df7948f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106457e50>]}
[0m16:33:14.953834 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:33:14.954388 [info ] [MainThread]: 
[0m16:33:14.959737 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m16:33:14.961195 [info ] [Thread-1 (]: 1 of 1 START sql view model jaffle_shop.dim_customers .......................... [RUN]
[0m16:33:14.963868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.dim_customers)
[0m16:33:14.964521 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m16:33:14.976694 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m16:33:14.979516 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_customers (compile): 16:33:14.964973 => 16:33:14.979033
[0m16:33:14.979996 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m16:33:15.015025 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."DIM_CUSTOMERS" because it is of type table
[0m16:33:15.025042 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."DIM_CUSTOMERS"
[0m16:33:15.035666 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m16:33:15.036163 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "RAW"."JAFFLE_SHOP"."DIM_CUSTOMERS" cascade
[0m16:33:15.036575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:15.522828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:15.538440 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m16:33:15.540634 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m16:33:15.541095 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace   view raw.jaffle_shop.dim_customers
  
   as (
    

with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
[0m16:33:16.016938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:16.041377 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_customers (execute): 16:33:14.980252 => 16:33:16.041141
[0m16:33:16.041860 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m16:33:16.144693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a55654b-ea33-4176-aa4b-1c0df7948f01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10683ff90>]}
[0m16:33:16.145705 [info ] [Thread-1 (]: 1 of 1 OK created sql view model jaffle_shop.dim_customers ..................... [[32mSUCCESS 1[0m in 1.18s]
[0m16:33:16.146782 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m16:33:16.149872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:16.150413 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m16:33:16.150908 [info ] [MainThread]: 
[0m16:33:16.151432 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m16:33:16.152217 [debug] [MainThread]: Command end result
[0m16:33:16.165259 [info ] [MainThread]: 
[0m16:33:16.165731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:16.166175 [info ] [MainThread]: 
[0m16:33:16.166584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:33:16.169227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7003353, "process_user_time": 3.42126, "process_kernel_time": 0.521924, "process_mem_max_rss": "130719744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:33:16.170206 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:16.169983 after 3.70 seconds
[0m16:33:16.170883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b2e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c95c90>]}
[0m16:33:16.171562 [debug] [MainThread]: Flushing usage events
[0m16:33:44.486633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ecb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106729fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758550>]}


============================== 16:33:44.493730 | ba986da8-8f7f-4670-b816-0d23f96ef84b ==============================
[0m16:33:44.493730 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:33:44.494733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'profiles_dir': '/Users/gabriellechen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customers', 'send_anonymous_usage_stats': 'True'}
[0m16:33:44.975359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba986da8-8f7f-4670-b816-0d23f96ef84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787c590>]}
[0m16:33:45.063769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba986da8-8f7f-4670-b816-0d23f96ef84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676e4d0>]}
[0m16:33:45.066333 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:33:45.093290 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:33:45.188221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:33:45.189229 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/dim_customers.sql
[0m16:33:45.527755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba986da8-8f7f-4670-b816-0d23f96ef84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9c290>]}
[0m16:33:45.541115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba986da8-8f7f-4670-b816-0d23f96ef84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b28210>]}
[0m16:33:45.541613 [info ] [MainThread]: Found 5 models, 3 seeds, 10 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:33:45.542102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba986da8-8f7f-4670-b816-0d23f96ef84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fe010>]}
[0m16:33:45.543724 [info ] [MainThread]: 
[0m16:33:45.544614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:45.545892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m16:33:45.561344 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m16:33:45.561813 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m16:33:45.562167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:46.199917 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:33:46.202847 [debug] [ThreadPool]: On list_raw: Close
[0m16:33:46.299465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m16:33:46.310168 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m16:33:46.310637 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m16:33:46.311013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:46.837946 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m16:33:46.840912 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m16:33:46.935681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba986da8-8f7f-4670-b816-0d23f96ef84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d075d0>]}
[0m16:33:46.937231 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:33:46.937975 [info ] [MainThread]: 
[0m16:33:46.942487 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m16:33:46.943128 [info ] [Thread-1 (]: 1 of 1 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m16:33:46.944052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.dim_customers)
[0m16:33:46.944543 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m16:33:46.955352 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m16:33:46.956369 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_customers (compile): 16:33:46.944845 => 16:33:46.956000
[0m16:33:46.957274 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m16:33:46.978892 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."DIM_CUSTOMERS" because it is of type view
[0m16:33:46.988340 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."DIM_CUSTOMERS"
[0m16:33:46.997597 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m16:33:46.998077 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "RAW"."JAFFLE_SHOP"."DIM_CUSTOMERS" cascade
[0m16:33:46.998455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:47.469613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:47.487235 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m16:33:47.489420 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m16:33:47.489878 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m16:33:49.398581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:33:49.424205 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_customers (execute): 16:33:46.958107 => 16:33:49.423967
[0m16:33:49.424661 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m16:33:49.508163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba986da8-8f7f-4670-b816-0d23f96ef84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3f510>]}
[0m16:33:49.509151 [info ] [Thread-1 (]: 1 of 1 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 2.56s]
[0m16:33:49.510088 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m16:33:49.512960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:49.513668 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m16:33:49.514514 [info ] [MainThread]: 
[0m16:33:49.515069 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m16:33:49.515835 [debug] [MainThread]: Command end result
[0m16:33:49.529584 [info ] [MainThread]: 
[0m16:33:49.530125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:49.530629 [info ] [MainThread]: 
[0m16:33:49.531150 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:33:49.533931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.110779, "process_user_time": 3.370546, "process_kernel_time": 0.510124, "process_mem_max_rss": "131235840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:33:49.535172 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:49.534961 after 5.11 seconds
[0m16:33:49.536568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106758790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102152110>]}
[0m16:33:49.537907 [debug] [MainThread]: Flushing usage events
[0m17:04:18.295141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c958d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfff90>]}


============================== 17:04:18.302138 | b1f32133-87bd-4a1e-8c0a-78134eada379 ==============================
[0m17:04:18.302138 [info ] [MainThread]: Running with dbt=1.7.7
[0m17:04:18.302966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:04:18.799777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eba590>]}
[0m17:04:18.893803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106597510>]}
[0m17:04:18.896469 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:04:18.922403 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m17:04:19.018560 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m17:04:19.019344 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/stg_customers.sql
[0m17:04:19.019753 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/stg_orders.sql
[0m17:04:19.020114 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/dim_customers.sql
[0m17:04:19.020552 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/stg_payments.sql
[0m17:04:19.020950 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/dim_orders.sql
[0m17:04:19.021293 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/dim_orders.sql
[0m17:04:19.021732 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/stg_payments.sql
[0m17:04:19.022088 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/stg_customers.sql
[0m17:04:19.022490 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/stg_orders.sql
[0m17:04:19.022952 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/dim_customers.sql
[0m17:04:19.437233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f0cd0>]}
[0m17:04:19.451257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ee010>]}
[0m17:04:19.451767 [info ] [MainThread]: Found 3 seeds, 5 models, 10 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:04:19.452316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f0cd0>]}
[0m17:04:19.454394 [info ] [MainThread]: 
[0m17:04:19.455418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:04:19.457343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m17:04:19.474489 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m17:04:19.475315 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m17:04:19.475820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:20.095082 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:04:20.097651 [debug] [ThreadPool]: On list_raw: Close
[0m17:04:20.550951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m17:04:20.561737 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m17:04:20.562208 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m17:04:20.562585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:21.026791 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m17:04:21.029402 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m17:04:21.125584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107328d10>]}
[0m17:04:21.126748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:04:21.127697 [info ] [MainThread]: 
[0m17:04:21.132225 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m17:04:21.132742 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m17:04:21.133180 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m17:04:21.133810 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m17:04:21.134420 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m17:04:21.135036 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m17:04:21.136893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m17:04:21.139554 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m17:04:21.141423 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m17:04:21.141923 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m17:04:21.142487 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m17:04:21.142906 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m17:04:21.157737 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:04:21.162858 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:04:21.167318 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m17:04:21.168489 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 17:04:21.158340 => 17:04:21.168212
[0m17:04:21.169252 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 17:04:21.163689 => 17:04:21.168939
[0m17:04:21.170825 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m17:04:21.170262 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 17:04:21.143253 => 17:04:21.170023
[0m17:04:21.169784 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m17:04:21.189817 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m17:04:21.208641 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m17:04:21.212278 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m17:04:21.215929 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m17:04:21.217528 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m17:04:21.218332 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m17:04:21.218812 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
[0m17:04:21.219528 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m17:04:21.219992 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_orders

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
[0m17:04:21.220449 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:04:21.220884 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_customers

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
[0m17:04:21.221462 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:04:21.222656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:22.023707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:04:22.025312 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:04:22.026438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:04:22.051603 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 17:04:21.171440 => 17:04:22.051363
[0m17:04:22.054631 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 17:04:21.209049 => 17:04:22.054303
[0m17:04:22.057356 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 17:04:21.212679 => 17:04:22.057133
[0m17:04:22.057806 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m17:04:22.058214 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m17:04:22.058608 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m17:04:22.154342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738cb10>]}
[0m17:04:22.155409 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f08d50>]}
[0m17:04:22.156237 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738f590>]}
[0m17:04:22.157116 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m17:04:22.158224 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 1.01s]
[0m17:04:22.159964 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 1.02s]
[0m17:04:22.161310 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m17:04:22.163011 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m17:04:22.163947 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m17:04:22.165805 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m17:04:22.166500 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_orders
[0m17:04:22.167490 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m17:04:22.168463 [info ] [Thread-1 (]: 5 of 5 START sql table model jaffle_shop.dim_orders ............................ [RUN]
[0m17:04:22.170498 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.dim_customers'
[0m17:04:22.180953 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m17:04:22.172661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.dim_orders)
[0m17:04:22.195140 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_orders
[0m17:04:22.203437 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_orders"
[0m17:04:22.204671 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m17:04:22.206593 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 17:04:22.181684 => 17:04:22.206100
[0m17:04:22.207919 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m17:04:22.233383 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_orders (compile): 17:04:22.195950 => 17:04:22.232738
[0m17:04:22.253164 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m17:04:22.253656 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_orders
[0m17:04:22.257298 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_orders"
[0m17:04:22.259621 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m17:04:22.260109 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m17:04:22.261935 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.dim_orders"
[0m17:04:22.262400 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:04:22.262916 [debug] [Thread-1 (]: On model.jaffle_shop.dim_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_orders"} */
create or replace transient table raw.jaffle_shop.dim_orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m17:04:22.264147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:24.071533 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:04:24.073205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:04:24.077990 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 17:04:22.208661 => 17:04:24.077508
[0m17:04:24.082149 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.dim_orders (execute): 17:04:22.254322 => 17:04:24.081777
[0m17:04:24.082773 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m17:04:24.083324 [debug] [Thread-1 (]: On model.jaffle_shop.dim_orders: Close
[0m17:04:24.179190 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738c510>]}
[0m17:04:24.180331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f32133-87bd-4a1e-8c0a-78134eada379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107593790>]}
[0m17:04:24.181087 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 2.01s]
[0m17:04:24.181937 [info ] [Thread-1 (]: 5 of 5 OK created sql table model jaffle_shop.dim_orders ....................... [[32mSUCCESS 1[0m in 2.01s]
[0m17:04:24.182773 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m17:04:24.183611 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_orders
[0m17:04:24.186937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:24.187385 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_orders' was properly closed.
[0m17:04:24.187872 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m17:04:24.188250 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m17:04:24.188551 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m17:04:24.189118 [info ] [MainThread]: 
[0m17:04:24.189728 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m17:04:24.191165 [debug] [MainThread]: Command end result
[0m17:04:24.206021 [info ] [MainThread]: 
[0m17:04:24.208288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:24.210750 [info ] [MainThread]: 
[0m17:04:24.211243 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:04:24.215561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9888816, "process_user_time": 3.880643, "process_kernel_time": 0.572275, "process_mem_max_rss": "132280320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:04:24.217008 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:24.216703 after 5.99 seconds
[0m17:04:24.217766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d22090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d20410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101785f90>]}
[0m17:04:24.218450 [debug] [MainThread]: Flushing usage events
[0m18:01:55.122399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047468d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477ffd0>]}


============================== 18:01:55.128936 | 2347f264-cb21-46f1-a792-5f70efac9727 ==============================
[0m18:01:55.128936 [info ] [MainThread]: Running with dbt=1.7.7
[0m18:01:55.129791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'profiles_dir': '/Users/gabriellechen/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:55.662843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505c910>]}
[0m18:01:55.749469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff4a90>]}
[0m18:01:55.752196 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:01:55.777172 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m18:01:55.792054 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:01:55.792624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a00190>]}
[0m18:01:57.173509 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_orders' in the 'models' section of file 'models/marts/core/schema.yml'
[0m18:01:57.216086 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_dim_orders_order_id.9786299635' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.216684 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_order_id.a67b7c295d' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.217436 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_customer_id.23bcdc00e5' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.217916 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_dim_orders_customer_id__customer_id__ref_customers_.2cd0bad1eb' (models/marts/core/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m18:01:57.218350 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_dim_orders_customer_id__customer_id__ref_customers_.2cd0bad1eb' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.218774 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.accepted_values_dim_orders_status__placed__shipped__completed__return_pending__returned.304a15493f' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.219202 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_amount.e1f1471120' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.219597 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_credit_card_amount.4b0e972055' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.219967 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_coupon_amount.dee365f98b' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.226487 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_bank_transfer_amount.55cfbaadc0' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.227209 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_dim_orders_gift_card_amount.eb308a6f43' (models/marts/core/schema.yml) depends on a node named 'dim_orders' in package '' which was not found
[0m18:01:57.278272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3ba50>]}
[0m18:01:57.293125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6bf10>]}
[0m18:01:57.293802 [info ] [MainThread]: Found 5 models, 3 seeds, 10 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:01:57.294340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de8b10>]}
[0m18:01:57.296410 [info ] [MainThread]: 
[0m18:01:57.297258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:57.298582 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:01:57.313939 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:01:57.314487 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:01:57.314937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:57.999152 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:01:58.002069 [debug] [ThreadPool]: On list_raw: Close
[0m18:01:58.135103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m18:01:58.145651 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m18:01:58.146133 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m18:01:58.146523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:58.905882 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:01:58.908823 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m18:01:59.452043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e140d0>]}
[0m18:01:59.453226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:59.453784 [info ] [MainThread]: 
[0m18:01:59.458702 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:01:59.459437 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:01:59.459893 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m18:01:59.460509 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m18:01:59.461444 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m18:01:59.462092 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m18:01:59.462993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m18:01:59.464160 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:01:59.465430 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m18:01:59.466316 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:01:59.467828 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:01:59.468671 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m18:01:59.479421 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:01:59.483644 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:01:59.488260 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m18:01:59.489633 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:01:59.475531 => 18:01:59.489183
[0m18:01:59.491098 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:01:59.469261 => 18:01:59.490635
[0m18:01:59.492344 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:01:59.494373 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 18:01:59.484187 => 18:01:59.493218
[0m18:01:59.495753 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:01:59.530408 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m18:01:59.536896 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:01:59.540980 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:01:59.544984 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m18:01:59.546709 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:01:59.547490 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:01:59.547911 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_orders

),

staged as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from staged
  );
[0m18:01:59.548760 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m18:01:59.549105 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_customers

),

staged as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from staged
  );
[0m18:01:59.549506 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:01:59.549903 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

staged as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from staged
  );
[0m18:01:59.550293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:59.551396 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:02:00.176385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:02:00.201686 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 18:01:59.541395 => 18:02:00.201450
[0m18:02:00.202139 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m18:02:00.291818 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:02:00.296689 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:01:59.496114 => 18:02:00.296374
[0m18:02:00.297744 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb7d10>]}
[0m18:02:00.298340 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:02:00.299163 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 0.83s]
[0m18:02:00.301452 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m18:02:00.416871 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d47710>]}
[0m18:02:00.417785 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 0.95s]
[0m18:02:00.418714 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:02:00.419702 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m18:02:00.420519 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.fct_orders ............................ [RUN]
[0m18:02:00.421616 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.fct_orders'
[0m18:02:00.422070 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m18:02:00.426956 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m18:02:00.427937 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.fct_orders (compile): 18:02:00.422351 => 18:02:00.427649
[0m18:02:00.428407 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m18:02:00.457394 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m18:02:00.459946 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.fct_orders"
[0m18:02:00.460423 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
create or replace transient table raw.jaffle_shop.fct_orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m18:02:00.460860 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:02:00.467975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:02:00.471346 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:01:59.537368 => 18:02:00.471105
[0m18:02:00.471777 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:02:00.581097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b2c50>]}
[0m18:02:00.584530 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 1.12s]
[0m18:02:00.586240 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:02:00.587384 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m18:02:00.587984 [info ] [Thread-2 (]: 5 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m18:02:00.588802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.dim_customers)
[0m18:02:00.589195 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m18:02:00.592500 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m18:02:00.593335 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (compile): 18:02:00.589437 => 18:02:00.593085
[0m18:02:00.593743 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m18:02:00.599247 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m18:02:00.602540 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m18:02:00.603389 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m18:02:00.603955 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:02.774276 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:02:02.778347 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.fct_orders (execute): 18:02:00.428726 => 18:02:02.777961
[0m18:02:02.778929 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: Close
[0m18:02:02.915754 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f83e10>]}
[0m18:02:02.916680 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.fct_orders ....................... [[32mSUCCESS 1[0m in 2.49s]
[0m18:02:02.917579 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m18:02:03.183566 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:02:03.187556 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (execute): 18:02:00.593997 => 18:02:03.187239
[0m18:02:03.188201 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: Close
[0m18:02:03.287606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2347f264-cb21-46f1-a792-5f70efac9727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea2e90>]}
[0m18:02:03.288624 [info ] [Thread-2 (]: 5 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 2.70s]
[0m18:02:03.289659 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m18:02:03.292470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:03.292995 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:02:03.293431 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m18:02:03.293858 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m18:02:03.294303 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m18:02:03.294748 [info ] [MainThread]: 
[0m18:02:03.295178 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m18:02:03.296556 [debug] [MainThread]: Command end result
[0m18:02:03.313138 [info ] [MainThread]: 
[0m18:02:03.313732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:03.314447 [info ] [MainThread]: 
[0m18:02:03.315089 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:02:03.318498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.265883, "process_user_time": 4.860849, "process_kernel_time": 0.579547, "process_mem_max_rss": "133615616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:02:03.319729 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:03.319428 after 8.27 seconds
[0m18:02:03.320552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1001ba110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100279210>]}
[0m18:02:03.321334 [debug] [MainThread]: Flushing usage events
[0m18:03:36.570765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebe550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f27c90>]}


============================== 18:03:36.579272 | c1bd9650-8db6-4410-8a9c-d37bcd195d15 ==============================
[0m18:03:36.579272 [info ] [MainThread]: Running with dbt=1.7.7
[0m18:03:36.580341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:37.051491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5c810>]}
[0m18:03:37.143836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108771390>]}
[0m18:03:37.145265 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:03:37.171540 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m18:03:37.267377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:37.268407 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/schema.yml
[0m18:03:37.508874 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_customers_.00a9e332cf' (models/marts/core/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m18:03:37.525088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109480b10>]}
[0m18:03:37.540198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109300950>]}
[0m18:03:37.540786 [info ] [MainThread]: Found 5 models, 3 seeds, 19 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:03:37.541431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941ae90>]}
[0m18:03:37.543649 [info ] [MainThread]: 
[0m18:03:37.544605 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:03:37.545947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:03:37.561000 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:03:37.561836 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:03:37.562904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:38.216180 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:03:38.218984 [debug] [ThreadPool]: On list_raw: Close
[0m18:03:38.315737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m18:03:38.326190 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m18:03:38.326666 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m18:03:38.327050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:38.960784 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m18:03:38.963796 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m18:03:39.064268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109403f10>]}
[0m18:03:39.065550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:39.066673 [info ] [MainThread]: 
[0m18:03:39.071353 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:03:39.071830 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:03:39.072263 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m18:03:39.072990 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m18:03:39.073704 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m18:03:39.074305 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m18:03:39.075254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m18:03:39.076696 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:03:39.078732 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m18:03:39.079592 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:03:39.080116 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:03:39.080504 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m18:03:39.091198 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:03:39.094025 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:03:39.097607 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m18:03:39.098587 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:03:39.080767 => 18:03:39.098321
[0m18:03:39.099268 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:03:39.091571 => 18:03:39.098983
[0m18:03:39.099703 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:03:39.100226 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:03:39.100717 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 18:03:39.094594 => 18:03:39.100479
[0m18:03:39.165799 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m18:03:39.184622 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:03:39.185509 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:03:39.194816 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m18:03:39.196850 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:03:39.198158 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:03:39.198984 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_orders

),

staged as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from staged
  );
[0m18:03:39.200358 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m18:03:39.201054 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_customers

),

staged as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from staged
  );
[0m18:03:39.201764 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:03:39.202585 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

staged as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from staged
  );
[0m18:03:39.203325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:39.205624 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:03:39.852041 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:03:39.878755 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:03:39.122897 => 18:03:39.878519
[0m18:03:39.879928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:03:39.880382 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:03:39.882963 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:03:39.100999 => 18:03:39.882744
[0m18:03:39.884246 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:03:39.894916 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:03:39.898824 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 18:03:39.175693 => 18:03:39.898509
[0m18:03:39.899392 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m18:03:39.994353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a1390>]}
[0m18:03:39.995449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e6810>]}
[0m18:03:39.996341 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 0.92s]
[0m18:03:39.997266 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m18:03:39.998464 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:03:39.999381 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:03:40.023834 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109480450>]}
[0m18:03:40.024780 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 0.95s]
[0m18:03:40.025926 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m18:03:40.027452 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m18:03:40.028383 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m18:03:40.029210 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m18:03:40.029943 [info ] [Thread-1 (]: 5 of 5 START sql table model jaffle_shop.fct_orders ............................ [RUN]
[0m18:03:40.030967 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.dim_customers'
[0m18:03:40.031850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.fct_orders)
[0m18:03:40.032363 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m18:03:40.032820 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m18:03:40.037446 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m18:03:40.041745 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m18:03:40.042792 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 18:03:40.033119 => 18:03:40.042516
[0m18:03:40.043249 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.fct_orders (compile): 18:03:40.037886 => 18:03:40.043015
[0m18:03:40.043677 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m18:03:40.044537 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m18:03:40.071981 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m18:03:40.074991 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m18:03:40.077297 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m18:03:40.079029 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.fct_orders"
[0m18:03:40.079695 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m18:03:40.080221 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
create or replace transient table raw.jaffle_shop.fct_orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m18:03:40.080669 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:03:40.081044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:41.394496 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:03:41.398320 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 18:03:40.045310 => 18:03:41.397999
[0m18:03:41.398908 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m18:03:41.488446 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ed310>]}
[0m18:03:41.489525 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 1.46s]
[0m18:03:41.490460 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m18:03:41.562300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:03:41.567549 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.fct_orders (execute): 18:03:40.072276 => 18:03:41.567221
[0m18:03:41.568159 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m18:03:41.705745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bd9650-8db6-4410-8a9c-d37bcd195d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e3fd0>]}
[0m18:03:41.706675 [info ] [Thread-1 (]: 5 of 5 OK created sql table model jaffle_shop.fct_orders ....................... [[32mSUCCESS 1[0m in 1.67s]
[0m18:03:41.707650 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m18:03:41.710500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:41.711046 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m18:03:41.711405 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:03:41.711748 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m18:03:41.712087 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m18:03:41.712501 [info ] [MainThread]: 
[0m18:03:41.712926 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m18:03:41.714363 [debug] [MainThread]: Command end result
[0m18:03:41.727770 [info ] [MainThread]: 
[0m18:03:41.728384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:41.728895 [info ] [MainThread]: 
[0m18:03:41.729563 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:03:41.732656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2314067, "process_user_time": 3.719176, "process_kernel_time": 0.525458, "process_mem_max_rss": "130109440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:03:41.733637 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:41.733428 after 5.23 seconds
[0m18:03:41.734180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f487d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f484d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039adf90>]}
[0m18:03:41.734645 [debug] [MainThread]: Flushing usage events
[0m18:04:03.085126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff9e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fffd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11000ac90>]}


============================== 18:04:03.093357 | 813b64ba-ce63-4e3e-b347-a8672eb53a2e ==============================
[0m18:04:03.093357 [info ] [MainThread]: Running with dbt=1.7.7
[0m18:04:03.094424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'profiles_dir': '/Users/gabriellechen/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:03.555138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111167110>]}
[0m18:04:03.645665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111294f50>]}
[0m18:04:03.648352 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:04:03.675628 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m18:04:03.770584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:03.771671 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/schema.yml
[0m18:04:04.148171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111350190>]}
[0m18:04:04.163267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b0410>]}
[0m18:04:04.163826 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:04:04.164294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111333d0>]}
[0m18:04:04.166533 [info ] [MainThread]: 
[0m18:04:04.167724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:04:04.168994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:04:04.184685 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:04:04.185142 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:04:04.185474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:04.754730 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:04:04.757707 [debug] [ThreadPool]: On list_raw: Close
[0m18:04:04.960563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m18:04:04.971197 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m18:04:04.971666 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m18:04:04.972049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:05.371344 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:04:05.373474 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m18:04:05.476002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11167b790>]}
[0m18:04:05.477217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:05.477976 [info ] [MainThread]: 
[0m18:04:05.481726 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:04:05.482493 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:04:05.483196 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m18:04:05.484136 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m18:04:05.484851 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m18:04:05.485453 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m18:04:05.486331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m18:04:05.487454 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:04:05.488239 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m18:04:05.488679 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:04:05.489217 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:04:05.490168 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m18:04:05.500992 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:04:05.504695 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:04:05.509433 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m18:04:05.510647 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:04:05.501332 => 18:04:05.510332
[0m18:04:05.511118 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:04:05.490988 => 18:04:05.510892
[0m18:04:05.511581 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:04:05.512112 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 18:04:05.505277 => 18:04:05.511817
[0m18:04:05.512832 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:04:05.537412 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m18:04:05.549007 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:04:05.552497 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:04:05.556006 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m18:04:05.557297 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:04:05.558041 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_orders

),

staged as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from staged
  );
[0m18:04:05.558904 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:04:05.559301 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:04:05.560181 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m18:04:05.560538 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_customers

),

staged as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from staged
  );
[0m18:04:05.562004 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

staged as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from staged
  );
[0m18:04:05.562541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:05.563090 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:04:06.273141 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:04:06.274764 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:04:06.276174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:04:06.315378 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 18:04:05.552890 => 18:04:06.315143
[0m18:04:06.316263 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:04:05.513228 => 18:04:06.316051
[0m18:04:06.318846 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:04:05.549355 => 18:04:06.318627
[0m18:04:06.319290 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m18:04:06.319685 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:04:06.320076 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:04:06.408522 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111745a10>]}
[0m18:04:06.409581 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136da10>]}
[0m18:04:06.410459 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m18:04:06.411376 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 0.92s]
[0m18:04:06.412630 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:04:06.413584 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m18:04:06.414690 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m18:04:06.415376 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.fct_orders ............................ [RUN]
[0m18:04:06.416295 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.fct_orders'
[0m18:04:06.416732 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m18:04:06.423760 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m18:04:06.425136 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.fct_orders (compile): 18:04:06.417017 => 18:04:06.424733
[0m18:04:06.425561 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m18:04:06.450743 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m18:04:06.453411 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.fct_orders"
[0m18:04:06.454975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116d5c90>]}
[0m18:04:06.456511 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
create or replace transient table raw.jaffle_shop.fct_orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m18:04:06.457557 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 0.97s]
[0m18:04:06.458114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:04:06.458720 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:04:06.460482 [debug] [Thread-3 (]: Began running node model.jaffle_shop.dim_customers
[0m18:04:06.461016 [info ] [Thread-3 (]: 5 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m18:04:06.462132 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.dim_customers)
[0m18:04:06.462772 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.dim_customers
[0m18:04:06.467165 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m18:04:06.468212 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.dim_customers (compile): 18:04:06.463642 => 18:04:06.467906
[0m18:04:06.468618 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.dim_customers
[0m18:04:06.471995 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m18:04:06.474438 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m18:04:06.475270 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m18:04:06.476026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:07.898994 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:04:07.901749 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.dim_customers (execute): 18:04:06.468862 => 18:04:07.901524
[0m18:04:07.902156 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: Close
[0m18:04:07.991919 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116be210>]}
[0m18:04:07.992878 [info ] [Thread-3 (]: 5 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 1.53s]
[0m18:04:07.993910 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.dim_customers
[0m18:04:08.593036 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:04:08.597304 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.fct_orders (execute): 18:04:06.425813 => 18:04:08.596973
[0m18:04:08.597907 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: Close
[0m18:04:08.703852 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813b64ba-ce63-4e3e-b347-a8672eb53a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116bcb90>]}
[0m18:04:08.704820 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.fct_orders ....................... [[32mSUCCESS 1[0m in 2.29s]
[0m18:04:08.705781 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m18:04:08.708678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:08.709222 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:04:08.709667 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:04:08.710097 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m18:04:08.710521 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m18:04:08.711001 [info ] [MainThread]: 
[0m18:04:08.711425 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m18:04:08.712814 [debug] [MainThread]: Command end result
[0m18:04:08.727795 [info ] [MainThread]: 
[0m18:04:08.728655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:08.729754 [info ] [MainThread]: 
[0m18:04:08.730286 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:04:08.732806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7154546, "process_user_time": 3.738138, "process_kernel_time": 0.521965, "process_mem_max_rss": "131985408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:04:08.733995 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:08.733688 after 5.72 seconds
[0m18:04:08.734570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11000bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba12050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad3590>]}
[0m18:04:08.735006 [debug] [MainThread]: Flushing usage events
[0m18:13:09.296593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111feb210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112053f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112074890>]}


============================== 18:13:09.304654 | 24598685-19e7-4567-8340-87d7cf22c4c7 ==============================
[0m18:13:09.304654 [info ] [MainThread]: Running with dbt=1.7.7
[0m18:13:09.305627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:13:09.788450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24598685-19e7-4567-8340-87d7cf22c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fea0d0>]}
[0m18:13:09.874675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24598685-19e7-4567-8340-87d7cf22c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132edd50>]}
[0m18:13:09.877150 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:13:09.900729 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m18:13:09.995623 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:13:09.996459 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
[0m18:13:10.438032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24598685-19e7-4567-8340-87d7cf22c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357c190>]}
[0m18:13:10.453437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24598685-19e7-4567-8340-87d7cf22c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133249d0>]}
[0m18:13:10.453981 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:13:10.454440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24598685-19e7-4567-8340-87d7cf22c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113541a10>]}
[0m18:13:10.456570 [info ] [MainThread]: 
[0m18:13:10.457440 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:10.458846 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_jaffle_shop'
[0m18:13:10.476122 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m18:13:10.476583 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m18:13:10.476971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:11.196713 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m18:13:11.200089 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m18:13:11.327928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24598685-19e7-4567-8340-87d7cf22c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11337e710>]}
[0m18:13:11.329051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:13:11.329677 [info ] [MainThread]: 
[0m18:13:11.333913 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:13:11.334465 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.raw_orders ............................... [RUN]
[0m18:13:11.335317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now source.jaffle_shop.jaffle_shop.raw_orders)
[0m18:13:11.335794 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:13:11.336359 [debug] [Thread-1 (]: Timing info for source.jaffle_shop.jaffle_shop.raw_orders (compile): 18:13:11.336090 => 18:13:11.336100
[0m18:13:11.336817 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:13:11.348135 [debug] [Thread-1 (]: Using snowflake connection "source.jaffle_shop.jaffle_shop.raw_orders"
[0m18:13:11.348645 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.raw_orders"} */
select
      max(_etl_loaded_at) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from raw.jaffle_shop.raw_orders
[0m18:13:11.349058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:12.497751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:12.500559 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.raw_orders: Close
[0m18:13:12.963937 [debug] [Thread-1 (]: Timing info for source.jaffle_shop.jaffle_shop.raw_orders (execute): 18:13:11.337104 => 18:13:12.963505
[0m18:13:12.965205 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of jaffle_shop.raw_orders ......................... [[31mERROR STALE[0m in 1.63s]
[0m18:13:12.966159 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:13:12.967845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:12.968311 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.raw_orders' was properly closed.
[0m18:13:12.984979 [info ] [MainThread]: 
[0m18:13:12.985587 [info ] [MainThread]: Done.
[0m18:13:12.988361 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 3.7547433, "process_user_time": 3.301687, "process_kernel_time": 0.500047, "process_mem_max_rss": "129200128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:13:12.989115 [debug] [MainThread]: Command `dbt source freshness` failed at 18:13:12.988979 after 3.76 seconds
[0m18:13:12.989535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120767d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe98d0>]}
[0m18:13:12.990069 [debug] [MainThread]: Flushing usage events
[0m18:18:20.389806 [error] [MainThread]: Encountered an error:

[0m18:18:20.411868 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/local/Cellar/python@3.11/3.11.7_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.7_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:18:20.418127 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 79369.7, "process_user_time": 7.186324, "process_kernel_time": 5.242929, "process_mem_max_rss": "112369664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:18:20.420132 [debug] [MainThread]: Command `dbt docs serve` failed at 18:18:20.419836 after 79369.70 seconds
[0m18:18:20.421418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae77e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ec190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6ad010>]}
[0m18:18:20.422491 [debug] [MainThread]: Flushing usage events
[0m18:19:29.064645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146e9ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147509d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114723510>]}


============================== 18:19:29.071999 | 6acfb7b5-3033-4479-9e7c-919665b6a0a3 ==============================
[0m18:19:29.071999 [info ] [MainThread]: Running with dbt=1.7.7
[0m18:19:29.073902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:19:29.648248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6acfb7b5-3033-4479-9e7c-919665b6a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11472ff10>]}
[0m18:19:29.740978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6acfb7b5-3033-4479-9e7c-919665b6a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158fc350>]}
[0m18:19:29.742565 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:19:29.765068 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m18:19:29.838412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:29.838868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:29.845803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6acfb7b5-3033-4479-9e7c-919665b6a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ac9710>]}
[0m18:19:29.850763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6acfb7b5-3033-4479-9e7c-919665b6a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b0c110>]}
[0m18:19:29.851314 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:19:29.851847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6acfb7b5-3033-4479-9e7c-919665b6a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115913110>]}
[0m18:19:29.855232 [info ] [MainThread]: 
[0m18:19:29.856294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:19:29.858081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_jaffle_shop'
[0m18:19:29.878692 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m18:19:29.879238 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m18:19:29.879632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:30.987275 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m18:19:30.990796 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m18:19:31.102136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6acfb7b5-3033-4479-9e7c-919665b6a0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ed3590>]}
[0m18:19:31.104018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:31.104835 [info ] [MainThread]: 
[0m18:19:31.109317 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:19:31.109857 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:19:31.110372 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m18:19:31.111496 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:19:31.112515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m18:19:31.113721 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:19:31.115211 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m18:19:31.116593 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_customers'
[0m18:19:31.117105 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:19:31.117656 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:19:31.118343 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m18:19:31.118863 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:19:31.128976 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:19:31.131865 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:19:31.134785 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m18:19:31.136643 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 18:19:31.135151 => 18:19:31.136388
[0m18:19:31.137744 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:19:31.129331 => 18:19:31.137433
[0m18:19:31.138196 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:19:31.119661 => 18:19:31.137968
[0m18:19:31.138789 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:19:31.139332 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:19:31.139806 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 18:19:31.132244 => 18:19:31.139574
[0m18:19:31.140218 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:19:31.140857 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 18:19:31.140512 => 18:19:31.140539
[0m18:19:31.141408 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:19:31.141164 => 18:19:31.141174
[0m18:19:31.141848 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m18:19:31.142374 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:19:31.142137 => 18:19:31.142146
[0m18:19:31.143958 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:19:31.144954 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:19:31.146304 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 18:19:31.145683 => 18:19:31.145711
[0m18:19:31.147472 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:19:31.148145 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:19:31.148868 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:19:31.150410 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m18:19:31.150959 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m18:19:31.151997 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now seed.jaffle_shop.raw_orders)
[0m18:19:31.152726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now seed.jaffle_shop.raw_payments)
[0m18:19:31.153231 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m18:19:31.154213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m18:19:31.154936 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:19:31.155644 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:19:31.156485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m18:19:31.156978 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m18:19:31.159054 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 18:19:31.157303 => 18:19:31.158768
[0m18:19:31.162358 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 18:19:31.159364 => 18:19:31.162085
[0m18:19:31.162895 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m18:19:31.178559 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m18:19:31.179045 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:19:31.179445 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:19:31.189130 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m18:19:31.190284 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 18:19:31.189959 => 18:19:31.189979
[0m18:19:31.191044 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 18:19:31.190650 => 18:19:31.190662
[0m18:19:31.192492 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:19:31.193087 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 18:19:31.163211 => 18:19:31.192839
[0m18:19:31.194152 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:19:31.194941 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 18:19:31.179701 => 18:19:31.194579
[0m18:19:31.195401 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m18:19:31.195966 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m18:19:31.196500 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:19:31.197076 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m18:19:31.197934 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m18:19:31.198553 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 18:19:31.198294 => 18:19:31.198303
[0m18:19:31.199333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m18:19:31.199867 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 18:19:31.199632 => 18:19:31.199640
[0m18:19:31.200265 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m18:19:31.201361 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m18:19:31.201808 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:19:31.202765 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m18:19:31.209663 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m18:19:31.211010 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m18:19:31.215605 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m18:19:31.216260 [debug] [Thread-3 (]: Began running node model.jaffle_shop.dim_customers
[0m18:19:31.217102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m18:19:31.218179 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now model.jaffle_shop.dim_customers)
[0m18:19:31.218779 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 18:19:31.203037 => 18:19:31.218477
[0m18:19:31.219277 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m18:19:31.219779 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.dim_customers
[0m18:19:31.220282 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 18:19:31.211416 => 18:19:31.220030
[0m18:19:31.220703 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m18:19:31.225849 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m18:19:31.229421 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m18:19:31.229922 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:19:31.230538 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 18:19:31.230291 => 18:19:31.230301
[0m18:19:31.231361 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 18:19:31.231102 => 18:19:31.231112
[0m18:19:31.232040 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 18:19:31.221055 => 18:19:31.231688
[0m18:19:31.233136 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m18:19:31.233610 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.dim_customers (compile): 18:19:31.226279 => 18:19:31.233359
[0m18:19:31.234683 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m18:19:31.235130 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m18:19:31.235610 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m18:19:31.236070 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.dim_customers
[0m18:19:31.236547 [debug] [Thread-2 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m18:19:31.237095 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 18:19:31.236865 => 18:19:31.236872
[0m18:19:31.237825 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.fct_orders)
[0m18:19:31.238651 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.dim_customers (execute): 18:19:31.238373 => 18:19:31.238383
[0m18:19:31.239746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278)
[0m18:19:31.240758 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m18:19:31.241305 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m18:19:31.242524 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.dim_customers
[0m18:19:31.242981 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m18:19:31.243478 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m18:19:31.248300 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m18:19:31.248962 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m18:19:31.257519 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m18:19:31.258397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075)
[0m18:19:31.259274 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_customers, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m18:19:31.260218 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.fct_orders (compile): 18:19:31.243797 => 18:19:31.259844
[0m18:19:31.260606 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m18:19:31.261101 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m18:19:31.261909 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (compile): 18:19:31.249582 => 18:19:31.261408
[0m18:19:31.262425 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m18:19:31.267289 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m18:19:31.273956 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m18:19:31.274490 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m18:19:31.275098 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.fct_orders (execute): 18:19:31.274845 => 18:19:31.274854
[0m18:19:31.275890 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (execute): 18:19:31.275640 => 18:19:31.275647
[0m18:19:31.276957 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m18:19:31.277471 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (compile): 18:19:31.262857 => 18:19:31.277228
[0m18:19:31.278464 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m18:19:31.278976 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (compile): 18:19:31.267654 => 18:19:31.278736
[0m18:19:31.279566 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:19:31.280457 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m18:19:31.281087 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:19:31.281588 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m18:19:31.282785 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:19:31.283351 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (execute): 18:19:31.283107 => 18:19:31.283115
[0m18:19:31.284061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278, now test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:19:31.284667 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (execute): 18:19:31.284368 => 18:19:31.284376
[0m18:19:31.285127 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:19:31.286249 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m18:19:31.286826 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:19:31.287823 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m18:19:31.292864 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:19:31.293428 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m18:19:31.298720 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:19:31.299428 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m18:19:31.300393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075, now test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768)
[0m18:19:31.301698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_payments_payment_id.3744510712, now test.jaffle_shop.not_null_fct_orders_amount.66810a8d08)
[0m18:19:31.302588 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m18:19:31.303063 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 18:19:31.288119 => 18:19:31.302829
[0m18:19:31.311726 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:19:31.303594 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd (compile): 18:19:31.293858 => 18:19:31.303333
[0m18:19:31.310751 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768"
[0m18:19:31.312586 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 18:19:31.312182 => 18:19:31.312194
[0m18:19:31.304061 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m18:19:31.313676 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:19:31.315595 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:19:31.316706 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768 (compile): 18:19:31.304350 => 18:19:31.316290
[0m18:19:31.324109 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_amount.66810a8d08"
[0m18:19:31.325465 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd (execute): 18:19:31.324976 => 18:19:31.324989
[0m18:19:31.326260 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m18:19:31.326988 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m18:19:31.328840 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:19:31.330219 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d, now test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab)
[0m18:19:31.331066 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768 (execute): 18:19:31.330749 => 18:19:31.330760
[0m18:19:31.331513 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_amount.66810a8d08 (compile): 18:19:31.317239 => 18:19:31.331289
[0m18:19:31.331982 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m18:19:31.332433 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m18:19:31.333842 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m18:19:31.334511 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m18:19:31.335463 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd, now test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568)
[0m18:19:31.342846 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab"
[0m18:19:31.343726 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m18:19:31.344664 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_amount.66810a8d08 (execute): 18:19:31.344262 => 18:19:31.344274
[0m18:19:31.345340 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m18:19:31.346515 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab (compile): 18:19:31.335849 => 18:19:31.346117
[0m18:19:31.347767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768, now test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63)
[0m18:19:31.349928 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m18:19:31.358831 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568"
[0m18:19:31.359530 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m18:19:31.360231 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m18:19:31.361030 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m18:19:31.362036 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab (execute): 18:19:31.361653 => 18:19:31.361664
[0m18:19:31.368094 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568 (compile): 18:19:31.350486 => 18:19:31.367674
[0m18:19:31.370852 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63"
[0m18:19:31.372088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_amount.66810a8d08, now test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b)
[0m18:19:31.373835 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m18:19:31.374568 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m18:19:31.375367 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m18:19:31.376181 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m18:19:31.377082 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63 (compile): 18:19:31.362592 => 18:19:31.376669
[0m18:19:31.377879 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568 (execute): 18:19:31.377484 => 18:19:31.377496
[0m18:19:31.386280 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b"
[0m18:19:31.387671 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab, now test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487)
[0m18:19:31.388437 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m18:19:31.390137 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m18:19:31.391071 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m18:19:31.391981 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b (compile): 18:19:31.378327 => 18:19:31.391595
[0m18:19:31.392764 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63 (execute): 18:19:31.392391 => 18:19:31.392403
[0m18:19:31.393502 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m18:19:31.400909 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487"
[0m18:19:31.401691 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m18:19:31.403440 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m18:19:31.404677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568, now test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0)
[0m18:19:31.405710 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b (execute): 18:19:31.405316 => 18:19:31.405328
[0m18:19:31.406506 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m18:19:31.407317 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487 (compile): 18:19:31.394011 => 18:19:31.406949
[0m18:19:31.407938 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m18:19:31.409438 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m18:19:31.410571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63, now test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd)
[0m18:19:31.411316 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m18:19:31.418679 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0"
[0m18:19:31.419457 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m18:19:31.420187 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m18:19:31.421064 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487 (execute): 18:19:31.420668 => 18:19:31.420679
[0m18:19:31.422347 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b, now test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5)
[0m18:19:31.435306 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0 (compile): 18:19:31.411778 => 18:19:31.434803
[0m18:19:31.437988 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd"
[0m18:19:31.439675 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m18:19:31.440341 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m18:19:31.440977 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m18:19:31.453582 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0 (execute): 18:19:31.453209 => 18:19:31.453220
[0m18:19:31.451829 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5"
[0m18:19:31.456454 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5 (compile): 18:19:31.441751 => 18:19:31.456038
[0m18:19:31.457102 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m18:19:31.457844 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5 (execute): 18:19:31.457496 => 18:19:31.457505
[0m18:19:31.459520 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m18:19:31.455149 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m18:19:31.452781 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd (compile): 18:19:31.422873 => 18:19:31.452330
[0m18:19:31.460632 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m18:19:31.461394 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd (execute): 18:19:31.461039 => 18:19:31.461048
[0m18:19:31.462823 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m18:19:31.464723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:31.465325 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd' was properly closed.
[0m18:19:31.465957 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m18:19:31.466462 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m18:19:31.467034 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487' was properly closed.
[0m18:19:31.474330 [debug] [MainThread]: Command end result
[0m18:19:31.498024 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m18:19:31.498567 [info ] [MainThread]: Building catalog
[0m18:19:31.504922 [debug] [ThreadPool]: Acquiring new snowflake connection 'raw.information_schema'
[0m18:19:31.529888 [debug] [ThreadPool]: Using snowflake connection "raw.information_schema"
[0m18:19:31.531132 [debug] [ThreadPool]: On raw.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "raw.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from raw.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('fct_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('dim_customers')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from raw.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('fct_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('dim_customers')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:19:31.532707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:34.606326 [debug] [ThreadPool]: SQL status: SUCCESS 39 in 3.0 seconds
[0m18:19:34.622461 [debug] [ThreadPool]: On raw.information_schema: Close
[0m18:19:34.776453 [info ] [MainThread]: Catalog written to /Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/target/catalog.json
[0m18:19:34.779128 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.783002, "process_user_time": 3.409092, "process_kernel_time": 0.59189, "process_mem_max_rss": "125800448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:19:34.779911 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:19:34.779770 after 5.78 seconds
[0m18:19:34.780279 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:19:34.780808 [debug] [MainThread]: Connection 'raw.information_schema' was properly closed.
[0m18:19:34.781341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114751010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114723190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ed08d0>]}
[0m18:19:34.781770 [debug] [MainThread]: Flushing usage events
[0m18:19:55.170806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8fdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96be90>]}


============================== 18:19:55.177563 | db752830-8637-4fef-8f4e-fa4d6c431815 ==============================
[0m18:19:55.177563 [info ] [MainThread]: Running with dbt=1.7.7
[0m18:19:55.178360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:19:55.547499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db752830-8637-4fef-8f4e-fa4d6c431815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb3ea50>]}
[0m18:19:55.644114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db752830-8637-4fef-8f4e-fa4d6c431815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07bc50>]}
[0m11:57:14.369415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baaeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10badc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10badc510>]}


============================== 11:57:14.387121 | 597bf0b5-f270-4320-9abd-23e34ba2d8c1 ==============================
[0m11:57:14.387121 [info ] [MainThread]: Running with dbt=1.7.7
[0m11:57:14.389134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:57:15.032376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa1510>]}
[0m11:57:15.164446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c258350>]}
[0m11:57:15.167687 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:57:15.190064 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m11:57:15.288957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:57:15.290413 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
[0m11:57:15.291567 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
[0m11:57:15.824903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d18a510>]}
[0m11:57:15.838925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd15350>]}
[0m11:57:15.839438 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m11:57:15.839988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d183950>]}
[0m11:57:15.844029 [info ] [MainThread]: 
[0m11:57:15.845489 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:15.847634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m11:57:15.864361 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m11:57:15.864904 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m11:57:15.865531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:17.362000 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:57:17.365012 [debug] [ThreadPool]: On list_raw: Close
[0m11:57:17.485078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m11:57:17.495415 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m11:57:17.495881 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m11:57:17.496242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:18.150623 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m11:57:18.153062 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m11:57:18.337370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d125210>]}
[0m11:57:18.338390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:18.338894 [info ] [MainThread]: 
[0m11:57:18.343205 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:57:18.343696 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m11:57:18.344128 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m11:57:18.344758 [info ] [Thread-1 (]: 1 of 5 START sql view model jaffle_shop.stg_customers .......................... [RUN]
[0m11:57:18.345606 [info ] [Thread-2 (]: 2 of 5 START sql view model jaffle_shop.stg_orders ............................. [RUN]
[0m11:57:18.346278 [info ] [Thread-3 (]: 3 of 5 START sql view model jaffle_shop.stg_payments ........................... [RUN]
[0m11:57:18.347236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m11:57:18.348985 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m11:57:18.349977 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m11:57:18.350857 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:57:18.352319 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:57:18.353202 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:57:18.361887 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:57:18.372139 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:57:18.376491 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:57:18.378478 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 11:57:18.353571 => 11:57:18.377972
[0m11:57:18.378959 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 11:57:18.362797 => 11:57:18.378719
[0m11:57:18.379473 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:57:18.379974 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:57:18.380509 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 11:57:18.373655 => 11:57:18.380267
[0m11:57:18.432679 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:57:18.434743 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:57:18.435164 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:57:18.439441 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:57:18.440330 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m11:57:18.441213 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m11:57:18.441692 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_orders

),

staged as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from staged
  );
[0m11:57:18.442284 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_customers

),

staged as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from staged
  );
[0m11:57:18.443178 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m11:57:18.443596 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:57:18.443975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:18.444384 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

staged as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from staged
  );
[0m11:57:18.447409 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:57:19.161084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:19.187351 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 11:57:18.380836 => 11:57:19.187117
[0m11:57:19.187812 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:57:19.223590 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:19.229347 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 11:57:18.416605 => 11:57:19.229021
[0m11:57:19.230193 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m11:57:19.281312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d555810>]}
[0m11:57:19.282505 [info ] [Thread-1 (]: 1 of 5 OK created sql view model jaffle_shop.stg_customers ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m11:57:19.283548 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:57:19.344723 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:57:19.349372 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 11:57:18.435833 => 11:57:19.348976
[0m11:57:19.350060 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m11:57:19.382831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d531490>]}
[0m11:57:19.384131 [info ] [Thread-2 (]: 2 of 5 OK created sql view model jaffle_shop.stg_orders ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m11:57:19.385195 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:57:19.449745 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd88190>]}
[0m11:57:19.450551 [info ] [Thread-3 (]: 3 of 5 OK created sql view model jaffle_shop.stg_payments ...................... [[32mSUCCESS 1[0m in 1.10s]
[0m11:57:19.451400 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:57:19.452327 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m11:57:19.453074 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:57:19.453762 [info ] [Thread-4 (]: 4 of 5 START sql table model jaffle_shop.dim_customers ......................... [RUN]
[0m11:57:19.454654 [info ] [Thread-1 (]: 5 of 5 START sql table model jaffle_shop.fct_orders ............................ [RUN]
[0m11:57:19.455775 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.dim_customers'
[0m11:57:19.456899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.fct_orders)
[0m11:57:19.457483 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:57:19.457902 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:57:19.464281 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:57:19.469606 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:57:19.470604 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 11:57:19.458176 => 11:57:19.470326
[0m11:57:19.471174 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.fct_orders (compile): 11:57:19.465288 => 11:57:19.470833
[0m11:57:19.471611 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:57:19.472044 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:57:19.519518 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m11:57:19.525592 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m11:57:19.527966 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m11:57:19.529843 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.fct_orders"
[0m11:57:19.530394 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m11:57:19.530960 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
create or replace transient table raw.jaffle_shop.fct_orders
         as
        (

with orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
        );
[0m11:57:19.531408 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:57:19.531778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:57:21.715954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:57:21.716630 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:57:21.719398 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.fct_orders (execute): 11:57:19.481189 => 11:57:21.719172
[0m11:57:21.721893 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 11:57:19.472848 => 11:57:21.721672
[0m11:57:21.722328 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m11:57:21.722953 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m11:57:21.818028 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce5ced0>]}
[0m11:57:21.819075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597bf0b5-f270-4320-9abd-23e34ba2d8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4ea250>]}
[0m11:57:21.819780 [info ] [Thread-4 (]: 4 of 5 OK created sql table model jaffle_shop.dim_customers .................... [[32mSUCCESS 1[0m in 2.36s]
[0m11:57:21.820611 [info ] [Thread-1 (]: 5 of 5 OK created sql table model jaffle_shop.fct_orders ....................... [[32mSUCCESS 1[0m in 2.36s]
[0m11:57:21.821545 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:57:21.822899 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:57:21.825262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:21.825693 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m11:57:21.826006 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m11:57:21.826306 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m11:57:21.826599 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:57:21.826962 [info ] [MainThread]: 
[0m11:57:21.827332 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m11:57:21.828684 [debug] [MainThread]: Command end result
[0m11:57:21.850109 [info ] [MainThread]: 
[0m11:57:21.850932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:21.851599 [info ] [MainThread]: 
[0m11:57:21.852298 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:57:21.861929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.631092, "process_user_time": 4.468309, "process_kernel_time": 0.83734, "process_mem_max_rss": "133574656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:57:21.863631 [debug] [MainThread]: Command `dbt run` succeeded at 11:57:21.863298 after 7.63 seconds
[0m11:57:21.864445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a596c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d60d0>]}
[0m11:57:21.865172 [debug] [MainThread]: Flushing usage events
[0m12:04:20.552683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522bfd0>]}


============================== 12:04:20.557237 | 72eb5c32-10e7-43ba-be64-f0f6903cf4d6 ==============================
[0m12:04:20.557237 [info ] [MainThread]: Running with dbt=1.7.7
[0m12:04:20.558079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select assert_stg_payments_amount_is_positive', 'send_anonymous_usage_stats': 'True'}
[0m12:04:20.934717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72eb5c32-10e7-43ba-be64-f0f6903cf4d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b14550>]}
[0m12:04:21.024744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72eb5c32-10e7-43ba-be64-f0f6903cf4d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a75450>]}
[0m12:04:21.025610 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:04:21.050076 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m12:04:21.112957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:04:21.113668 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://tests/assert_stg_payments_amount_is_positive.sql
[0m12:04:21.291746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72eb5c32-10e7-43ba-be64-f0f6903cf4d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670b310>]}
[0m12:04:21.313779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72eb5c32-10e7-43ba-be64-f0f6903cf4d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668f410>]}
[0m12:04:21.314732 [info ] [MainThread]: Found 5 models, 3 seeds, 21 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:04:21.315438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72eb5c32-10e7-43ba-be64-f0f6903cf4d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644fad0>]}
[0m12:04:21.318869 [info ] [MainThread]: 
[0m12:04:21.322467 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:04:21.325119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_jaffle_shop'
[0m12:04:21.353724 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m12:04:21.355063 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m12:04:21.355708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:22.374768 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m12:04:22.378235 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m12:04:22.472406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72eb5c32-10e7-43ba-be64-f0f6903cf4d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f42d0>]}
[0m12:04:22.473648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:22.474361 [info ] [MainThread]: 
[0m12:04:22.477875 [debug] [Thread-1 (]: Began running node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m12:04:22.478636 [info ] [Thread-1 (]: 1 of 1 START test assert_stg_payments_amount_is_positive ....................... [RUN]
[0m12:04:22.479802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now test.jaffle_shop.assert_stg_payments_amount_is_positive)
[0m12:04:22.480634 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m12:04:22.492597 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_amount_is_positive"
[0m12:04:22.493643 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.assert_stg_payments_amount_is_positive (compile): 12:04:22.481469 => 12:04:22.493327
[0m12:04:22.494061 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m12:04:22.530639 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.assert_stg_payments_amount_is_positive"
[0m12:04:22.532139 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.assert_stg_payments_amount_is_positive"
[0m12:04:22.532612 [debug] [Thread-1 (]: On test.jaffle_shop.assert_stg_payments_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select * from raw.jaffle_shop.stg_payments
)

select
    order_id,
    sum(amount) as total_amount
from payments
group by 1
having not(total_amount >= 0)
      
    ) dbt_internal_test
[0m12:04:22.533022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:23.340338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:04:23.349205 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.assert_stg_payments_amount_is_positive (execute): 12:04:22.494317 => 12:04:23.348855
[0m12:04:23.349736 [debug] [Thread-1 (]: On test.jaffle_shop.assert_stg_payments_amount_is_positive: Close
[0m12:04:23.448401 [info ] [Thread-1 (]: 1 of 1 PASS assert_stg_payments_amount_is_positive ............................. [[32mPASS[0m in 0.97s]
[0m12:04:23.449542 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m12:04:23.453111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:23.454109 [debug] [MainThread]: Connection 'test.jaffle_shop.assert_stg_payments_amount_is_positive' was properly closed.
[0m12:04:23.455005 [info ] [MainThread]: 
[0m12:04:23.456388 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m12:04:23.457752 [debug] [MainThread]: Command end result
[0m12:04:23.473447 [info ] [MainThread]: 
[0m12:04:23.475239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:23.475816 [info ] [MainThread]: 
[0m12:04:23.476453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:04:23.480168 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9870365, "process_user_time": 3.110038, "process_kernel_time": 0.348512, "process_mem_max_rss": "126410752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:04:23.481668 [debug] [MainThread]: Command `dbt test` succeeded at 12:04:23.481368 after 2.99 seconds
[0m12:04:23.482592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cb20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e15b50>]}
[0m12:04:23.483293 [debug] [MainThread]: Flushing usage events
[0m13:27:59.647554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11134e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ab250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113dc910>]}


============================== 13:27:59.654813 | 6a2b5d50-2643-4711-8388-5ba2bce5fda3 ==============================
[0m13:27:59.654813 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:27:59.655843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select source:jaffle_shop', 'send_anonymous_usage_stats': 'True'}
[0m13:28:00.205335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2b5d50-2643-4711-8388-5ba2bce5fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112578950>]}
[0m13:28:00.292787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a2b5d50-2643-4711-8388-5ba2bce5fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7b8d0>]}
[0m13:28:00.295315 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:28:00.316838 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:28:00.420075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:00.421489 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
[0m13:28:00.993746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a2b5d50-2643-4711-8388-5ba2bce5fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128a6210>]}
[0m13:28:01.009194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a2b5d50-2643-4711-8388-5ba2bce5fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125f4c10>]}
[0m13:28:01.009708 [info ] [MainThread]: Found 3 seeds, 5 models, 25 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:28:01.010162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2b5d50-2643-4711-8388-5ba2bce5fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112645d50>]}
[0m13:28:01.012137 [info ] [MainThread]: 
[0m13:28:01.013110 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:01.014564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_jaffle_shop'
[0m13:28:01.032540 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m13:28:01.033013 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m13:28:01.033359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:01.994692 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m13:28:01.997176 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m13:28:02.260350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2b5d50-2643-4711-8388-5ba2bce5fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125f8590>]}
[0m13:28:02.261580 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:02.262219 [info ] [MainThread]: 
[0m13:28:02.267380 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:28:02.268707 [debug] [Thread-2 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:28:02.268110 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_jaffle_shop_raw_customers_id ................. [RUN]
[0m13:28:02.270686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319)
[0m13:28:02.271561 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:28:02.269449 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_jaffle_shop_raw_orders_id .................... [RUN]
[0m13:28:02.288846 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946'
[0m13:28:02.290704 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:28:02.280591 [debug] [Thread-4 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:28:02.272413 [debug] [Thread-3 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:28:02.314881 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:28:02.315677 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:28:02.316190 [info ] [Thread-4 (]: 4 of 4 START test source_unique_jaffle_shop_raw_orders_id ...................... [RUN]
[0m13:28:02.316713 [info ] [Thread-3 (]: 3 of 4 START test source_unique_jaffle_shop_raw_customers_id ................... [RUN]
[0m13:28:02.318011 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2'
[0m13:28:02.318765 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319 (compile): 13:28:02.273210 => 13:28:02.318483
[0m13:28:02.319556 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273'
[0m13:28:02.320026 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946 (compile): 13:28:02.291670 => 13:28:02.319785
[0m13:28:02.320631 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:28:02.321411 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:28:02.322158 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:28:02.322875 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:28:02.332120 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:28:02.348063 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:28:02.358908 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:28:02.361900 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:28:02.363334 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2 (compile): 13:28:02.323427 => 13:28:02.362971
[0m13:28:02.364176 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273 (compile): 13:28:02.343124 => 13:28:02.363694
[0m13:28:02.365299 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:28:02.366003 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:28:02.366369 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:28:02.366781 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:28:02.367392 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from raw.jaffle_shop.raw_customers
where id is null



      
    ) dbt_internal_test
[0m13:28:02.367826 [debug] [Thread-2 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from raw.jaffle_shop.raw_orders
where id is null



      
    ) dbt_internal_test
[0m13:28:02.370626 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:28:02.373370 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:28:02.373885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:02.374304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:02.378384 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:28:02.378947 [debug] [Thread-4 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.raw_orders
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:28:02.379770 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:28:02.380423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:28:02.382161 [debug] [Thread-3 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.raw_customers
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:28:02.384665 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:03.690259 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:28:03.699656 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946 (execute): 13:28:02.359258 => 13:28:03.699340
[0m13:28:03.700179 [debug] [Thread-2 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946: Close
[0m13:28:03.849024 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_jaffle_shop_raw_orders_id .......................... [[32mPASS[0m in 1.56s]
[0m13:28:03.850083 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:28:03.942071 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:28:03.945061 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273 (execute): 13:28:02.370944 => 13:28:03.944703
[0m13:28:03.945656 [debug] [Thread-3 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273: Close
[0m13:28:03.971788 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:28:03.973483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:28:03.976162 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2 (execute): 13:28:02.368101 => 13:28:03.975808
[0m13:28:03.978732 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319 (execute): 13:28:02.332491 => 13:28:03.978373
[0m13:28:03.979341 [debug] [Thread-4 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2: Close
[0m13:28:03.979932 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319: Close
[0m13:28:04.062246 [info ] [Thread-3 (]: 3 of 4 PASS source_unique_jaffle_shop_raw_customers_id ......................... [[32mPASS[0m in 1.74s]
[0m13:28:04.063237 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:28:04.082618 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_jaffle_shop_raw_orders_id ............................ [[32mPASS[0m in 1.76s]
[0m13:28:04.084484 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:28:04.083683 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_jaffle_shop_raw_customers_id ....................... [[32mPASS[0m in 1.81s]
[0m13:28:04.085593 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:28:04.088076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:04.088538 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319' was properly closed.
[0m13:28:04.088903 [debug] [MainThread]: Connection 'test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946' was properly closed.
[0m13:28:04.089291 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2' was properly closed.
[0m13:28:04.089930 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273' was properly closed.
[0m13:28:04.090522 [info ] [MainThread]: 
[0m13:28:04.091125 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m13:28:04.092917 [debug] [MainThread]: Command end result
[0m13:28:04.106939 [info ] [MainThread]: 
[0m13:28:04.107487 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:04.107857 [info ] [MainThread]: 
[0m13:28:04.108229 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:28:04.111256 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.5394945, "process_user_time": 3.535987, "process_kernel_time": 0.380074, "process_mem_max_rss": "134782976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:28:04.112115 [debug] [MainThread]: Command `dbt test` succeeded at 13:28:04.111973 after 4.54 seconds
[0m13:28:04.112560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a8e890>]}
[0m13:28:04.113023 [debug] [MainThread]: Flushing usage events
[0m13:43:06.758182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba29c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e1310>]}


============================== 13:43:06.769062 | 9080bfbe-f760-4884-b12a-dec8f7b27f72 ==============================
[0m13:43:06.769062 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:43:06.770252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --select +dim_customers', 'send_anonymous_usage_stats': 'True'}
[0m13:43:07.483744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbe1750>]}
[0m13:43:07.570791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a93d0>]}
[0m13:43:07.572224 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:43:07.597050 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:43:07.800126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:07.800667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:07.808764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce19a50>]}
[0m13:43:07.880135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbecf50>]}
[0m13:43:07.880764 [info ] [MainThread]: Found 3 seeds, 5 models, 25 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:43:07.883899 [info ] [MainThread]: 
[0m13:43:07.885098 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:07.886460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m13:43:07.904805 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m13:43:07.905363 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m13:43:07.905879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:08.791209 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:43:08.794221 [debug] [ThreadPool]: On list_raw: Close
[0m13:43:08.885493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_jaffle_shop)
[0m13:43:08.896319 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m13:43:08.896791 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m13:43:08.897166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.454081 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m13:43:09.456843 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m13:43:09.585601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d2990>]}
[0m13:43:09.586811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:09.587484 [info ] [MainThread]: 
[0m13:43:09.591949 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m13:43:09.592439 [debug] [Thread-2 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:43:09.592881 [debug] [Thread-3 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:43:09.593319 [debug] [Thread-4 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:43:09.593912 [info ] [Thread-1 (]: 1 of 19 START sql view model jaffle_shop.stg_payments .......................... [RUN]
[0m13:43:09.594487 [info ] [Thread-2 (]: 2 of 19 START test source_not_null_jaffle_shop_raw_customers_id ................ [RUN]
[0m13:43:09.595032 [info ] [Thread-3 (]: 3 of 19 START test source_not_null_jaffle_shop_raw_orders_id ................... [RUN]
[0m13:43:09.595589 [info ] [Thread-4 (]: 4 of 19 START test source_unique_jaffle_shop_raw_customers_id .................. [RUN]
[0m13:43:09.597275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_payments)
[0m13:43:09.599292 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319'
[0m13:43:09.601241 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946'
[0m13:43:09.602183 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273'
[0m13:43:09.602630 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:43:09.603023 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:43:09.603407 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:43:09.603790 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:43:09.612971 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:43:09.626544 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:43:09.632040 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:43:09.638612 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:43:09.640079 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946 (compile): 13:43:09.627126 => 13:43:09.639715
[0m13:43:09.640578 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:43:09.604069 => 13:43:09.640338
[0m13:43:09.641008 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319 (compile): 13:43:09.613555 => 13:43:09.640785
[0m13:43:09.641735 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:43:09.642477 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273 (compile): 13:43:09.632493 => 13:43:09.642126
[0m13:43:09.642902 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:43:09.643660 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:43:09.665131 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:43:09.665614 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:43:09.691868 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:43:09.695829 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:43:09.698771 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:43:09.700223 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:43:09.700707 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view raw.jaffle_shop.stg_payments
  
   as (
    with source as (
    select * from raw.jaffle_shop.raw_payments

),

staged as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from staged
  );
[0m13:43:09.701501 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:43:09.702122 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:43:09.702516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:09.703275 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:43:09.703666 [debug] [Thread-2 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from raw.jaffle_shop.raw_customers
where id is null



      
    ) dbt_internal_test
[0m13:43:09.704091 [debug] [Thread-3 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from raw.jaffle_shop.raw_orders
where id is null



      
    ) dbt_internal_test
[0m13:43:09.705163 [debug] [Thread-4 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.raw_customers
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:09.705971 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:43:09.706472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:43:09.707232 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:43:10.324246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:10.352100 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:43:09.665921 => 13:43:10.351864
[0m13:43:10.352556 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m13:43:10.429120 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:10.434162 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946 (execute): 13:43:09.644295 => 13:43:10.433763
[0m13:43:10.434785 [debug] [Thread-3 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946: Close
[0m13:43:10.479406 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:10.482852 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319 (execute): 13:43:09.692128 => 13:43:10.482534
[0m13:43:10.483668 [debug] [Thread-2 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319: Close
[0m13:43:10.485302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf7cc90>]}
[0m13:43:10.488137 [info ] [Thread-1 (]: 1 of 19 OK created sql view model jaffle_shop.stg_payments ..................... [[32mSUCCESS 1[0m in 0.89s]
[0m13:43:10.489176 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:43:10.490117 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:43:10.491409 [info ] [Thread-1 (]: 5 of 19 START test source_unique_jaffle_shop_raw_orders_id ..................... [RUN]
[0m13:43:10.492313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2)
[0m13:43:10.492742 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:43:10.498705 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:43:10.500314 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2 (compile): 13:43:10.492992 => 13:43:10.499811
[0m13:43:10.500905 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:43:10.504484 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:43:10.505701 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:43:10.506139 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.raw_orders
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:10.506535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:10.591234 [info ] [Thread-3 (]: 3 of 19 PASS source_not_null_jaffle_shop_raw_orders_id ......................... [[32mPASS[0m in 0.99s]
[0m13:43:10.592355 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:43:10.593044 [debug] [Thread-3 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m13:43:10.593978 [info ] [Thread-3 (]: 6 of 19 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m13:43:10.595027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946, now test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278)
[0m13:43:10.595857 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m13:43:10.610194 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m13:43:10.611555 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (compile): 13:43:10.596178 => 13:43:10.611099
[0m13:43:10.612130 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m13:43:10.615398 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m13:43:10.617126 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m13:43:10.617669 [debug] [Thread-3 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from raw.jaffle_shop.stg_payments
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m13:43:10.618192 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:43:10.745876 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:10.749180 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273 (execute): 13:43:09.696349 => 13:43:10.748819
[0m13:43:10.749775 [debug] [Thread-4 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273: Close
[0m13:43:10.856073 [info ] [Thread-2 (]: 2 of 19 PASS source_not_null_jaffle_shop_raw_customers_id ...................... [[32mPASS[0m in 1.26s]
[0m13:43:10.857347 [info ] [Thread-4 (]: 4 of 19 PASS source_unique_jaffle_shop_raw_customers_id ........................ [[32mPASS[0m in 1.26s]
[0m13:43:10.858398 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:43:10.859161 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:43:10.859737 [debug] [Thread-2 (]: Began running node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m13:43:10.860343 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m13:43:10.860982 [info ] [Thread-2 (]: 7 of 19 START test assert_stg_payments_amount_is_positive ...................... [RUN]
[0m13:43:10.861510 [info ] [Thread-4 (]: 8 of 19 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m13:43:10.862466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319, now test.jaffle_shop.assert_stg_payments_amount_is_positive)
[0m13:43:10.863247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273, now test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075)
[0m13:43:10.863741 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m13:43:10.864208 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m13:43:10.868245 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_amount_is_positive"
[0m13:43:10.873561 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m13:43:10.874502 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.assert_stg_payments_amount_is_positive (compile): 13:43:10.864533 => 13:43:10.874246
[0m13:43:10.875186 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (compile): 13:43:10.868931 => 13:43:10.874738
[0m13:43:10.875630 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m13:43:10.876030 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m13:43:10.878882 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.assert_stg_payments_amount_is_positive"
[0m13:43:10.883329 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m13:43:10.885429 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m13:43:10.887089 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.assert_stg_payments_amount_is_positive"
[0m13:43:10.887726 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from raw.jaffle_shop.stg_payments
where payment_id is null



      
    ) dbt_internal_test
[0m13:43:10.888541 [debug] [Thread-2 (]: On test.jaffle_shop.assert_stg_payments_amount_is_positive: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.assert_stg_payments_amount_is_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select * from raw.jaffle_shop.stg_payments
)

select
    order_id,
    sum(amount) as total_amount
from payments
group by 1
having not(total_amount >= 0)
      
    ) dbt_internal_test
[0m13:43:10.889242 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:43:10.889877 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:43:11.235227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:11.238468 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2 (execute): 13:43:10.501285 => 13:43:11.238081
[0m13:43:11.239094 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2: Close
[0m13:43:11.327262 [info ] [Thread-1 (]: 5 of 19 PASS source_unique_jaffle_shop_raw_orders_id ........................... [[32mPASS[0m in 0.83s]
[0m13:43:11.328320 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:43:11.328967 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m13:43:11.329944 [info ] [Thread-1 (]: 9 of 19 START test unique_stg_payments_payment_id .............................. [RUN]
[0m13:43:11.331031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m13:43:11.331615 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m13:43:11.337268 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m13:43:11.338252 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (compile): 13:43:11.331969 => 13:43:11.337956
[0m13:43:11.338740 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m13:43:11.343922 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m13:43:11.345094 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m13:43:11.345551 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.stg_payments
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:11.345995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:11.602819 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:11.606218 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (execute): 13:43:10.612490 => 13:43:11.605828
[0m13:43:11.607063 [debug] [Thread-3 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m13:43:11.677152 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:11.680295 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (execute): 13:43:10.879250 => 13:43:11.679948
[0m13:43:11.680867 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m13:43:11.718007 [info ] [Thread-3 (]: 6 of 19 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 1.12s]
[0m13:43:11.719148 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m13:43:11.719826 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m13:43:11.720723 [info ] [Thread-3 (]: 10 of 19 START sql view model jaffle_shop.stg_customers ........................ [RUN]
[0m13:43:11.721859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278, now model.jaffle_shop.stg_customers)
[0m13:43:11.722445 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:43:11.726048 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:43:11.726983 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:43:11.722801 => 13:43:11.726694
[0m13:43:11.727453 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:43:11.735036 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:43:11.737230 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:43:11.738077 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view raw.jaffle_shop.stg_customers
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_customers

),

staged as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from staged
  );
[0m13:43:11.739231 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:43:11.791829 [info ] [Thread-4 (]: 8 of 19 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.93s]
[0m13:43:11.792699 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m13:43:11.793180 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m13:43:11.793813 [info ] [Thread-4 (]: 11 of 19 START sql view model jaffle_shop.stg_orders ........................... [RUN]
[0m13:43:11.794654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075, now model.jaffle_shop.stg_orders)
[0m13:43:11.795082 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:43:11.801605 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:43:11.802928 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:43:11.795511 => 13:43:11.802490
[0m13:43:11.803601 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:43:11.808036 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:43:11.809896 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:43:11.810730 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view raw.jaffle_shop.stg_orders
  
   as (
    with source as (

    select * from raw.jaffle_shop.raw_orders

),

staged as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from staged
  );
[0m13:43:11.811866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:43:11.863730 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:11.866850 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.assert_stg_payments_amount_is_positive (execute): 13:43:10.876286 => 13:43:11.866455
[0m13:43:11.880531 [debug] [Thread-2 (]: On test.jaffle_shop.assert_stg_payments_amount_is_positive: Close
[0m13:43:12.063388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:12.068859 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (execute): 13:43:11.339215 => 13:43:12.068479
[0m13:43:12.086171 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m13:43:12.140165 [info ] [Thread-2 (]: 7 of 19 PASS assert_stg_payments_amount_is_positive ............................ [[32mPASS[0m in 1.28s]
[0m13:43:12.141481 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m13:43:12.208283 [info ] [Thread-1 (]: 9 of 19 PASS unique_stg_payments_payment_id .................................... [[32mPASS[0m in 0.88s]
[0m13:43:12.209349 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m13:43:12.260415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:12.265109 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:43:11.727744 => 13:43:12.264787
[0m13:43:12.265718 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m13:43:12.358891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0bb290>]}
[0m13:43:12.359906 [info ] [Thread-3 (]: 10 of 19 OK created sql view model jaffle_shop.stg_customers ................... [[32mSUCCESS 1[0m in 0.64s]
[0m13:43:12.360824 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:43:12.361871 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:43:12.362814 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:43:12.363517 [info ] [Thread-2 (]: 12 of 19 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m13:43:12.364195 [info ] [Thread-1 (]: 13 of 19 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:43:12.365214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.assert_stg_payments_amount_is_positive, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:43:12.366250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_payments_payment_id.3744510712, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m13:43:12.366740 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:43:12.367201 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:43:12.373761 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:43:12.380351 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:43:12.382191 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 13:43:12.367521 => 13:43:12.381719
[0m13:43:12.383144 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 13:43:12.375101 => 13:43:12.382819
[0m13:43:12.383566 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:43:12.384161 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:43:12.387603 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:43:12.393047 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:43:12.394877 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:43:12.395782 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from raw.jaffle_shop.stg_customers
where customer_id is null



      
    ) dbt_internal_test
[0m13:43:12.397377 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:43:12.398049 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:43:12.398800 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:12.401920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:12.434286 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:12.439086 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:43:11.804003 => 13:43:12.438718
[0m13:43:12.443022 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m13:43:12.586550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c35d810>]}
[0m13:43:12.587288 [info ] [Thread-4 (]: 11 of 19 OK created sql view model jaffle_shop.stg_orders ...................... [[32mSUCCESS 1[0m in 0.79s]
[0m13:43:12.587979 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:43:12.588660 [debug] [Thread-3 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:43:12.589074 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:43:12.589631 [info ] [Thread-3 (]: 14 of 19 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m13:43:12.590154 [info ] [Thread-4 (]: 15 of 19 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:43:12.590886 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m13:43:12.591563 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:43:12.591985 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:43:12.592378 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:43:12.602743 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m13:43:12.608801 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:43:12.609701 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1 (compile): 13:43:12.592644 => 13:43:12.609443
[0m13:43:12.610236 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 13:43:12.603114 => 13:43:12.609997
[0m13:43:12.610648 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:43:12.611031 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:43:12.614845 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m13:43:12.618865 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:43:12.620545 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m13:43:12.621435 [debug] [Thread-3 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from raw.jaffle_shop.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m13:43:12.622204 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:43:12.623656 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:43:12.626673 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from raw.jaffle_shop.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m13:43:12.627604 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:43:12.949838 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:12.953604 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 13:43:12.384449 => 13:43:12.953230
[0m13:43:12.954499 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:43:13.089169 [info ] [Thread-2 (]: 12 of 19 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.72s]
[0m13:43:13.090241 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:43:13.090873 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:43:13.091645 [info ] [Thread-2 (]: 16 of 19 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:43:13.093152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:43:13.093918 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:43:13.099890 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:43:13.101241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:13.105137 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 13:43:12.388064 => 13:43:13.104797
[0m13:43:13.106064 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:43:13.107650 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 13:43:13.094286 => 13:43:13.107386
[0m13:43:13.108489 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:43:13.112354 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:43:13.115455 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:43:13.117199 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:43:13.118017 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:13.121269 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 13:43:12.615388 => 13:43:13.120813
[0m13:43:13.121982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:43:13.122682 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:43:13.215446 [info ] [Thread-4 (]: 15 of 19 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.62s]
[0m13:43:13.216636 [info ] [Thread-1 (]: 13 of 19 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.85s]
[0m13:43:13.217952 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:43:13.218934 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:43:13.440669 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:13.444055 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1 (execute): 13:43:12.611284 => 13:43:13.443671
[0m13:43:13.444676 [debug] [Thread-3 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m13:43:13.540548 [info ] [Thread-3 (]: 14 of 19 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.95s]
[0m13:43:13.541688 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:43:13.752572 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:13.755657 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 13:43:13.108846 => 13:43:13.755301
[0m13:43:13.756237 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:43:13.864481 [info ] [Thread-2 (]: 16 of 19 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.77s]
[0m13:43:13.865511 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:43:13.866523 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m13:43:13.867629 [info ] [Thread-4 (]: 17 of 19 START sql table model jaffle_shop.dim_customers ....................... [RUN]
[0m13:43:13.868721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now model.jaffle_shop.dim_customers)
[0m13:43:13.869283 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:43:13.873233 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:43:13.874204 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 13:43:13.869629 => 13:43:13.873915
[0m13:43:13.874986 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:43:13.910603 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:43:13.915294 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m13:43:13.916230 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
create or replace transient table raw.jaffle_shop.dim_customers
         as
        (with customers as (

    select * from raw.jaffle_shop.stg_customers

),

orders as (

    select * from raw.jaffle_shop.stg_orders

),

payments as (

    select * from raw.jaffle_shop.stg_payments

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
        );
[0m13:43:13.917028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:43:15.596311 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:43:15.600739 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 13:43:13.875496 => 13:43:15.600412
[0m13:43:15.601329 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m13:43:15.691057 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9080bfbe-f760-4884-b12a-dec8f7b27f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109765e10>]}
[0m13:43:15.691999 [info ] [Thread-4 (]: 17 of 19 OK created sql table model jaffle_shop.dim_customers .................. [[32mSUCCESS 1[0m in 1.82s]
[0m13:43:15.692990 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:43:15.694293 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:43:15.695172 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:43:15.696198 [info ] [Thread-3 (]: 18 of 19 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:43:15.697322 [info ] [Thread-2 (]: 19 of 19 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:43:15.698738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:43:15.699955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:43:15.700659 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:43:15.701240 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:43:15.710073 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:43:15.720940 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:43:15.722382 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 13:43:15.701773 => 13:43:15.721936
[0m13:43:15.723123 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:43:15.723919 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd (compile): 13:43:15.711061 => 13:43:15.723518
[0m13:43:15.729571 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:43:15.730370 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:43:15.735001 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:43:15.736154 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:43:15.737217 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:43:15.737654 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from raw.jaffle_shop.dim_customers
where customer_id is null



      
    ) dbt_internal_test
[0m13:43:15.738128 [debug] [Thread-2 (]: On test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:43:15.738583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:43:15.739014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:43:16.414667 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:16.415769 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:16.418570 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 13:43:15.724385 => 13:43:16.418212
[0m13:43:16.421044 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd (execute): 13:43:15.731044 => 13:43:16.420704
[0m13:43:16.421640 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:43:16.422207 [debug] [Thread-2 (]: On test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:43:16.509168 [info ] [Thread-3 (]: 18 of 19 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.81s]
[0m13:43:16.510160 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:43:16.527118 [info ] [Thread-2 (]: 19 of 19 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.83s]
[0m13:43:16.527956 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:43:16.530707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:16.531531 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:43:16.532020 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m13:43:16.532488 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d' was properly closed.
[0m13:43:16.532847 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:43:16.533334 [info ] [MainThread]: 
[0m13:43:16.533874 [info ] [MainThread]: Finished running 3 view models, 15 tests, 1 table model in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m13:43:16.537623 [debug] [MainThread]: Command end result
[0m13:43:16.549463 [info ] [MainThread]: 
[0m13:43:16.550153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:16.550712 [info ] [MainThread]: 
[0m13:43:16.551091 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m13:43:16.554090 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.866656, "process_user_time": 4.980904, "process_kernel_time": 0.707535, "process_mem_max_rss": "130658304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:43:16.555233 [debug] [MainThread]: Command `dbt build` succeeded at 13:43:16.554903 after 9.87 seconds
[0m13:43:16.556362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba2a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107625b90>]}
[0m13:43:16.557724 [debug] [MainThread]: Flushing usage events
[0m13:50:47.326930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d8650>]}


============================== 13:50:47.331575 | eccca7e8-37d3-4f0a-9a7f-d1dd201860c0 ==============================
[0m13:50:47.331575 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:50:47.332334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_jaffle_shop', 'send_anonymous_usage_stats': 'True'}
[0m13:50:47.656810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eccca7e8-37d3-4f0a-9a7f-d1dd201860c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270110>]}
[0m13:50:47.743496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eccca7e8-37d3-4f0a-9a7f-d1dd201860c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579ef90>]}
[0m13:50:47.744298 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:50:47.764695 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:50:47.813233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:47.814167 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
[0m13:50:48.172826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eccca7e8-37d3-4f0a-9a7f-d1dd201860c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a690>]}
[0m13:50:48.186639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eccca7e8-37d3-4f0a-9a7f-d1dd201860c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064783d0>]}
[0m13:50:48.187137 [info ] [MainThread]: Found 3 seeds, 5 models, 26 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:50:48.187591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccca7e8-37d3-4f0a-9a7f-d1dd201860c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105872150>]}
[0m13:50:48.188480 [warn ] [MainThread]: The selection criterion 'stg_jaffle_shop' does not match any nodes
[0m13:50:48.189799 [info ] [MainThread]: 
[0m13:50:48.190366 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:50:48.191139 [debug] [MainThread]: Command end result
[0m13:50:48.206442 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.93940234, "process_user_time": 2.635278, "process_kernel_time": 0.259964, "process_mem_max_rss": "121065472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:50:48.207335 [debug] [MainThread]: Command `dbt test` succeeded at 13:50:48.207108 after 0.94 seconds
[0m13:50:48.208027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050da3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106740f50>]}
[0m13:50:48.208755 [debug] [MainThread]: Flushing usage events
[0m13:52:09.550182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107eaad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110813250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110823fd0>]}


============================== 13:52:09.554728 | 307c3cbf-203f-4432-a1e2-17faf3bfec9b ==============================
[0m13:52:09.554728 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:52:09.555474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select stg_orders', 'send_anonymous_usage_stats': 'True'}
[0m13:52:09.889446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '307c3cbf-203f-4432-a1e2-17faf3bfec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111981750>]}
[0m13:52:09.976522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '307c3cbf-203f-4432-a1e2-17faf3bfec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f91550>]}
[0m13:52:09.977320 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:52:09.999412 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:52:10.042145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:10.042584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:10.050394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '307c3cbf-203f-4432-a1e2-17faf3bfec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119e1310>]}
[0m13:52:10.120384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '307c3cbf-203f-4432-a1e2-17faf3bfec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fde650>]}
[0m13:52:10.121005 [info ] [MainThread]: Found 3 seeds, 5 models, 26 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:52:10.121532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '307c3cbf-203f-4432-a1e2-17faf3bfec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db7ce10>]}
[0m13:52:10.123961 [info ] [MainThread]: 
[0m13:52:10.124952 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:10.126529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_jaffle_shop'
[0m13:52:10.147413 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m13:52:10.147893 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m13:52:10.148225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:10.737045 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m13:52:10.740134 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m13:52:10.840894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '307c3cbf-203f-4432-a1e2-17faf3bfec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11052cd90>]}
[0m13:52:10.842104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:10.842728 [info ] [MainThread]: 
[0m13:52:10.845853 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:52:10.846340 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:52:10.847068 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:52:10.848560 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:52:10.848096 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m13:52:10.852229 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:52:10.849739 [info ] [Thread-3 (]: 3 of 4 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:52:10.854000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m13:52:10.849189 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:52:10.855596 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a'
[0m13:52:10.856918 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m13:52:10.857451 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:52:10.858216 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:52:10.858611 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:52:10.859007 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:52:10.877817 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:52:10.886090 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m13:52:10.893765 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:52:10.902638 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:52:10.911320 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:52:10.912575 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1 (compile): 13:52:10.859286 => 13:52:10.912289
[0m13:52:10.913161 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 13:52:10.894132 => 13:52:10.912926
[0m13:52:10.913517 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:52:10.914002 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 13:52:10.886512 => 13:52:10.913777
[0m13:52:10.914483 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 13:52:10.903001 => 13:52:10.914245
[0m13:52:10.914827 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:52:10.936058 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m13:52:10.936471 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:52:10.936905 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:52:10.939676 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:52:10.942779 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:52:10.945675 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:52:10.946731 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m13:52:10.947927 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:52:10.948835 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:52:10.949321 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from raw.jaffle_shop.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m13:52:10.949821 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from raw.jaffle_shop.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from raw.jaffle_shop.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:52:10.950546 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:52:10.951036 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from raw.jaffle_shop.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:52:10.951566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:10.951989 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:52:10.952406 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from raw.jaffle_shop.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m13:52:10.952809 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:52:10.955604 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:52:11.437273 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:52:11.446938 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 13:52:10.940115 => 13:52:11.446613
[0m13:52:11.447678 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:52:11.463594 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:11.465094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:11.467794 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 13:52:10.943183 => 13:52:11.467451
[0m13:52:11.470355 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1 (execute): 13:52:10.915091 => 13:52:11.469995
[0m13:52:11.471261 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:52:11.471842 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m13:52:11.537611 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.68s]
[0m13:52:11.538819 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:52:11.569792 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.71s]
[0m13:52:11.571119 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.72s]
[0m13:52:11.572041 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:52:11.572716 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m13:52:12.071964 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:12.074381 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 13:52:10.937171 => 13:52:12.074071
[0m13:52:12.074881 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:52:12.167508 [info ] [Thread-3 (]: 3 of 4 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 1.31s]
[0m13:52:12.168368 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:52:12.171040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:12.171607 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1' was properly closed.
[0m13:52:12.172104 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:52:12.172663 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m13:52:12.173170 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m13:52:12.173738 [info ] [MainThread]: 
[0m13:52:12.174305 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m13:52:12.176104 [debug] [MainThread]: Command end result
[0m13:52:12.195637 [info ] [MainThread]: 
[0m13:52:12.196478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:12.197442 [info ] [MainThread]: 
[0m13:52:12.198469 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:52:12.201092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7079902, "process_user_time": 2.943325, "process_kernel_time": 0.312505, "process_mem_max_rss": "128036864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:12.202333 [debug] [MainThread]: Command `dbt test` succeeded at 13:52:12.201983 after 2.71 seconds
[0m13:52:12.204069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110844850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110844c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c25e150>]}
[0m13:52:12.204798 [debug] [MainThread]: Flushing usage events
[0m14:23:18.939501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb7b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc00d50>]}


============================== 14:23:18.946737 | 2f4315e9-ad5d-4041-bbde-dde9caace229 ==============================
[0m14:23:18.946737 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:23:18.947802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:19.450334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f4315e9-ad5d-4041-bbde-dde9caace229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110384590>]}
[0m14:23:19.549773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f4315e9-ad5d-4041-bbde-dde9caace229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbb8610>]}
[0m14:23:19.552349 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:23:19.576904 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:23:19.677912 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m14:23:19.678632 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/overview.md
[0m14:23:19.679005 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/order_status_jaffle_shop.md
[0m14:23:19.679979 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
[0m14:23:19.680456 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
[0m14:23:19.680886 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/docs.md
[0m14:23:19.681227 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/overview.md
[0m14:23:20.329286 [error] [MainThread]: Encountered an error:
Compilation Error
  Documentation for 'model.jaffle_shop.stg_orders' depends on doc 'order_status'  which was not found
[0m14:23:20.332728 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 1.4692684, "process_user_time": 3.365811, "process_kernel_time": 0.506605, "process_mem_max_rss": "120995840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:23:20.333644 [debug] [MainThread]: Command `dbt docs generate` failed at 14:23:20.333436 after 1.47 seconds
[0m14:23:20.335035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc02dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc00e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112dee10>]}
[0m14:23:20.335577 [debug] [MainThread]: Flushing usage events
[0m14:23:32.807025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a4ffd0>]}


============================== 14:23:32.811979 | 1073399d-0928-4642-9ac3-2071a4581421 ==============================
[0m14:23:32.811979 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:23:32.812866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m14:23:33.188969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1073399d-0928-4642-9ac3-2071a4581421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c08f50>]}
[0m14:23:33.284652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1073399d-0928-4642-9ac3-2071a4581421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113207250>]}
[0m14:23:33.665667 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m14:23:33.675371 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.7_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 456, in __init__
    self.server_bind()
  File "/usr/local/Cellar/python@3.11/3.11.7_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m14:23:33.683131 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.9326414, "process_user_time": 2.355207, "process_kernel_time": 0.257118, "process_mem_max_rss": "112435200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:23:33.689003 [debug] [MainThread]: Command `dbt docs serve` failed at 14:23:33.687231 after 0.94 seconds
[0m14:23:33.690498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131df7d0>]}
[0m14:23:33.693899 [debug] [MainThread]: Flushing usage events
[0m14:27:50.823813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110013f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f983e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110078b90>]}


============================== 14:27:50.832373 | 1c1c10f2-70f8-4a9e-940d-9eaebc3ff10d ==============================
[0m14:27:50.832373 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:27:50.833502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m14:27:51.308285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c1c10f2-70f8-4a9e-940d-9eaebc3ff10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e3d90>]}
[0m14:27:51.396198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c1c10f2-70f8-4a9e-940d-9eaebc3ff10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110095b10>]}
[0m14:27:51.398908 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:27:51.425423 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:27:51.523123 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m14:27:51.523985 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/overview.md
[0m14:27:51.524398 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/jaffle_shop/order_status_jaffle_shop.md
[0m14:27:51.525149 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/stg_jaffle_shop.yml
[0m14:27:51.525659 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/jaffle_shop/src_jaffle_shop.yml
[0m14:27:51.526114 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/docs.md
[0m14:27:51.526430 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/overview.md
[0m14:27:52.025104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c1c10f2-70f8-4a9e-940d-9eaebc3ff10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f6610>]}
[0m14:27:52.029119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c1c10f2-70f8-4a9e-940d-9eaebc3ff10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e82d0>]}
[0m14:27:52.029613 [info ] [MainThread]: Found 3 seeds, 5 models, 26 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:27:52.030182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1c10f2-70f8-4a9e-940d-9eaebc3ff10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111268e50>]}
[0m14:27:52.033415 [info ] [MainThread]: 
[0m14:27:52.034299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:52.035639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_jaffle_shop'
[0m14:27:52.053981 [debug] [ThreadPool]: Using snowflake connection "list_raw_jaffle_shop"
[0m14:27:52.054571 [debug] [ThreadPool]: On list_raw_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_jaffle_shop"} */
show terse objects in raw.jaffle_shop limit 10000
[0m14:27:52.055327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:52.925436 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m14:27:52.928403 [debug] [ThreadPool]: On list_raw_jaffle_shop: Close
[0m14:27:53.039603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1c10f2-70f8-4a9e-940d-9eaebc3ff10d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112a0a90>]}
[0m14:27:53.041682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:53.042337 [info ] [MainThread]: 
[0m14:27:53.048194 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:27:53.048824 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m14:27:53.051088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_jaffle_shop, now model.jaffle_shop.stg_customers)
[0m14:27:53.052073 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_customers
[0m14:27:53.049491 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:27:53.053770 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:27:53.054504 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:27:53.056149 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_customers'
[0m14:27:53.057827 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m14:27:53.059349 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:27:53.069386 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:27:53.069919 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m14:27:53.070372 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:27:53.074751 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:27:53.076811 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 14:27:53.075245 => 14:27:53.076544
[0m14:27:53.079862 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:27:53.080382 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 14:27:53.059909 => 14:27:53.080141
[0m14:27:53.080944 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_customers
[0m14:27:53.081826 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:27:53.082349 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 14:27:53.077161 => 14:27:53.082100
[0m14:27:53.082755 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 14:27:53.070663 => 14:27:53.082549
[0m14:27:53.083264 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 14:27:53.083025 => 14:27:53.083053
[0m14:27:53.083728 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 14:27:53.083513 => 14:27:53.083520
[0m14:27:53.084107 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:27:53.084486 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:27:53.085567 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_customers
[0m14:27:53.086719 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:27:53.087282 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 14:27:53.087040 => 14:27:53.087050
[0m14:27:53.087773 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 14:27:53.087541 => 14:27:53.087549
[0m14:27:53.088222 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_orders
[0m14:27:53.088742 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m14:27:53.089904 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:27:53.090808 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:27:53.091442 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now seed.jaffle_shop.raw_orders)
[0m14:27:53.092114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now seed.jaffle_shop.raw_payments)
[0m14:27:53.092578 [debug] [Thread-3 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m14:27:53.093210 [debug] [Thread-2 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m14:27:53.093838 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m14:27:53.094249 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m14:27:53.094963 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319)
[0m14:27:53.095634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946)
[0m14:27:53.097710 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 14:27:53.095903 => 14:27:53.097473
[0m14:27:53.099503 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 14:27:53.097997 => 14:27:53.099266
[0m14:27:53.099912 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m14:27:53.100303 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m14:27:53.100766 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_orders
[0m14:27:53.101159 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m14:27:53.110161 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m14:27:53.114587 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m14:27:53.115171 [debug] [Thread-4 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 14:27:53.114935 => 14:27:53.114945
[0m14:27:53.115645 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 14:27:53.115428 => 14:27:53.115435
[0m14:27:53.116889 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_orders
[0m14:27:53.117449 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946 (compile): 14:27:53.110501 => 14:27:53.117225
[0m14:27:53.118340 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m14:27:53.118817 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319 (compile): 14:27:53.101493 => 14:27:53.118578
[0m14:27:53.119297 [debug] [Thread-4 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m14:27:53.119767 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m14:27:53.120216 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m14:27:53.120665 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m14:27:53.121323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273)
[0m14:27:53.121918 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946 (execute): 14:27:53.121681 => 14:27:53.121688
[0m14:27:53.122579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2)
[0m14:27:53.123071 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319 (execute): 14:27:53.122844 => 14:27:53.122852
[0m14:27:53.123469 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m14:27:53.124444 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m14:27:53.124847 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m14:27:53.125764 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m14:27:53.132573 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m14:27:53.133100 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:27:53.137363 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m14:27:53.137965 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m14:27:53.138801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:27:53.139669 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m14:27:53.140189 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273 (compile): 14:27:53.126022 => 14:27:53.139948
[0m14:27:53.140675 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:27:53.141228 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2 (compile): 14:27:53.133406 => 14:27:53.140985
[0m14:27:53.141560 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m14:27:53.141953 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m14:27:53.146334 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:27:53.146830 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m14:27:53.150916 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m14:27:53.151484 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273 (execute): 14:27:53.151245 => 14:27:53.151252
[0m14:27:53.152108 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2 (execute): 14:27:53.151864 => 14:27:53.151871
[0m14:27:53.153327 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m14:27:53.153847 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 14:27:53.142210 => 14:27:53.153609
[0m14:27:53.154677 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m14:27:53.155082 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 14:27:53.147102 => 14:27:53.154876
[0m14:27:53.155532 [debug] [Thread-4 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m14:27:53.155974 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:27:53.156411 [debug] [Thread-1 (]: Began running node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m14:27:53.156879 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m14:27:53.157636 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273, now test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278)
[0m14:27:53.158159 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 14:27:53.157926 => 14:27:53.157933
[0m14:27:53.158811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2, now test.jaffle_shop.assert_stg_payments_amount_is_positive)
[0m14:27:53.159302 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 14:27:53.159079 => 14:27:53.159085
[0m14:27:53.159689 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m14:27:53.160634 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:27:53.161062 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m14:27:53.161981 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m14:27:53.166424 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m14:27:53.167062 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m14:27:53.171342 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.assert_stg_payments_amount_is_positive"
[0m14:27:53.171958 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m14:27:53.172818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075)
[0m14:27:53.173483 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (compile): 14:27:53.162263 => 14:27:53.173195
[0m14:27:53.174328 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m14:27:53.174777 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m14:27:53.175407 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.assert_stg_payments_amount_is_positive (compile): 14:27:53.167437 => 14:27:53.175061
[0m14:27:53.175779 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m14:27:53.176160 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m14:27:53.180286 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m14:27:53.180740 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m14:27:53.181230 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (execute): 14:27:53.180997 => 14:27:53.181004
[0m14:27:53.185578 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m14:27:53.186337 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.assert_stg_payments_amount_is_positive (execute): 14:27:53.186062 => 14:27:53.186087
[0m14:27:53.188022 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m14:27:53.189393 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (compile): 14:27:53.176407 => 14:27:53.188664
[0m14:27:53.190594 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.assert_stg_payments_amount_is_positive
[0m14:27:53.191176 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m14:27:53.191871 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (compile): 14:27:53.181485 => 14:27:53.191527
[0m14:27:53.192432 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m14:27:53.192959 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m14:27:53.193734 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278, now model.jaffle_shop.dim_customers)
[0m14:27:53.194170 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m14:27:53.194669 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (execute): 14:27:53.194442 => 14:27:53.194450
[0m14:27:53.195312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.assert_stg_payments_amount_is_positive, now model.jaffle_shop.fct_orders)
[0m14:27:53.195718 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m14:27:53.196205 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (execute): 14:27:53.195983 => 14:27:53.195989
[0m14:27:53.197118 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m14:27:53.197707 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m14:27:53.201387 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m14:27:53.202455 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m14:27:53.202973 [debug] [Thread-2 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m14:27:53.207106 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m14:27:53.207905 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m14:27:53.208844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m14:27:53.209383 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 14:27:53.197982 => 14:27:53.209145
[0m14:27:53.210324 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_payments_payment_id.3744510712, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:27:53.211066 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m14:27:53.211575 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.fct_orders (compile): 14:27:53.203335 => 14:27:53.211345
[0m14:27:53.212053 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m14:27:53.212485 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m14:27:53.217707 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m14:27:53.218319 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m14:27:53.218987 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 14:27:53.218738 => 14:27:53.218747
[0m14:27:53.225544 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:27:53.226297 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.fct_orders (execute): 14:27:53.226018 => 14:27:53.226029
[0m14:27:53.227557 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m14:27:53.228118 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1 (compile): 14:27:53.212759 => 14:27:53.227849
[0m14:27:53.229421 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m14:27:53.230081 [debug] [Thread-4 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:27:53.230835 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 14:27:53.219350 => 14:27:53.230589
[0m14:27:53.231297 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m14:27:53.231808 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m14:27:53.232974 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_customers, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:27:53.233519 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m14:27:53.234136 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1 (execute): 14:27:53.233872 => 14:27:53.233881
[0m14:27:53.234895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m14:27:53.235405 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:27:53.236047 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 14:27:53.235699 => 14:27:53.235706
[0m14:27:53.237504 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m14:27:53.238214 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m14:27:53.247515 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:27:53.248899 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m14:27:53.249397 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:27:53.254505 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m14:27:53.255240 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:27:53.256980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m14:27:53.257787 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 14:27:53.238687 => 14:27:53.257392
[0m14:27:53.261333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd)
[0m14:27:53.262128 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:27:53.262840 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 14:27:53.249720 => 14:27:53.262485
[0m14:27:53.263490 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:27:53.264134 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:27:53.271617 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:27:53.272347 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m14:27:53.273206 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 14:27:53.272800 => 14:27:53.272811
[0m14:27:53.279406 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:27:53.280433 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 14:27:53.280038 => 14:27:53.280049
[0m14:27:53.282308 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:27:53.283044 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 14:27:53.264542 => 14:27:53.282680
[0m14:27:53.284614 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m14:27:53.285440 [debug] [Thread-4 (]: Began running node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m14:27:53.286488 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:27:53.287189 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd (compile): 14:27:53.273592 => 14:27:53.286838
[0m14:27:53.287851 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m14:27:53.288868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768)
[0m14:27:53.289516 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 14:27:53.289262 => 14:27:53.289270
[0m14:27:53.289939 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:27:53.290921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.not_null_fct_orders_amount.66810a8d08)
[0m14:27:53.291611 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m14:27:53.293241 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:27:53.294065 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd (execute): 14:27:53.293704 => 14:27:53.293714
[0m14:27:53.294727 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m14:27:53.301926 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768"
[0m14:27:53.302834 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m14:27:53.304439 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:27:53.312732 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_amount.66810a8d08"
[0m14:27:53.314088 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_dim_customers_customer_id.dd91cd1c8d, now test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab)
[0m14:27:53.315019 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m14:27:53.315744 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768 (compile): 14:27:53.295173 => 14:27:53.315380
[0m14:27:53.316555 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m14:27:53.317750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_dim_customers_customer_id.15c9f1e2fd, now test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568)
[0m14:27:53.318562 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_fct_orders_amount.66810a8d08 (compile): 14:27:53.304898 => 14:27:53.318178
[0m14:27:53.319289 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m14:27:53.327203 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab"
[0m14:27:53.327982 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m14:27:53.328683 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m14:27:53.329509 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768 (execute): 14:27:53.329124 => 14:27:53.329136
[0m14:27:53.336727 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568"
[0m14:27:53.337707 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_fct_orders_amount.66810a8d08 (execute): 14:27:53.337299 => 14:27:53.337311
[0m14:27:53.338490 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab (compile): 14:27:53.319743 => 14:27:53.338103
[0m14:27:53.340105 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768
[0m14:27:53.341896 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_fct_orders_amount.66810a8d08
[0m14:27:53.342666 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m14:27:53.343460 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m14:27:53.344192 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568 (compile): 14:27:53.330055 => 14:27:53.343818
[0m14:27:53.344980 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m14:27:53.345842 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab (execute): 14:27:53.345471 => 14:27:53.345481
[0m14:27:53.346980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_fct_orders_status__placed__shipped__completed__return_pending__returned.0aa0973768, now test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63)
[0m14:27:53.347717 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m14:27:53.349410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_amount.66810a8d08, now test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b)
[0m14:27:53.352087 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab
[0m14:27:53.352781 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m14:27:53.353653 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568 (execute): 14:27:53.353254 => 14:27:53.353265
[0m14:27:53.354334 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m14:27:53.355152 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m14:27:53.362130 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63"
[0m14:27:53.363412 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568
[0m14:27:53.367799 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b"
[0m14:27:53.368777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_bank_transfer_amount.d808dd4fab, now test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487)
[0m14:27:53.369516 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m14:27:53.370398 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63 (compile): 14:27:53.355639 => 14:27:53.370134
[0m14:27:53.370766 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m14:27:53.371258 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b (compile): 14:27:53.363720 => 14:27:53.370970
[0m14:27:53.371951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_coupon_amount.8a700a9568, now test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0)
[0m14:27:53.372367 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m14:27:53.376890 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487"
[0m14:27:53.377521 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m14:27:53.378167 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m14:27:53.378850 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63 (execute): 14:27:53.378484 => 14:27:53.378495
[0m14:27:53.379777 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b (execute): 14:27:53.379402 => 14:27:53.379412
[0m14:27:53.384575 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0"
[0m14:27:53.385716 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63
[0m14:27:53.386137 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487 (compile): 14:27:53.372629 => 14:27:53.385924
[0m14:27:53.387006 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b
[0m14:27:53.387576 [debug] [Thread-4 (]: Began running node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m14:27:53.388192 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m14:27:53.388804 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0 (compile): 14:27:53.380247 => 14:27:53.388536
[0m14:27:53.389258 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m14:27:53.389959 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_credit_card_amount.56131cba63, now test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd)
[0m14:27:53.390517 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487 (execute): 14:27:53.390281 => 14:27:53.390288
[0m14:27:53.391103 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m14:27:53.392131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_fct_orders_customer_id.16fe324f7b, now test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5)
[0m14:27:53.392848 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m14:27:53.394405 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487
[0m14:27:53.395227 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0 (execute): 14:27:53.394844 => 14:27:53.394854
[0m14:27:53.395892 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m14:27:53.406480 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd"
[0m14:27:53.410039 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0
[0m14:27:53.419671 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5"
[0m14:27:53.421035 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd (compile): 14:27:53.396318 => 14:27:53.420593
[0m14:27:53.421859 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m14:27:53.422921 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5 (compile): 14:27:53.412087 => 14:27:53.422354
[0m14:27:53.424299 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd (execute): 14:27:53.423822 => 14:27:53.423836
[0m14:27:53.425241 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m14:27:53.427047 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd
[0m14:27:53.428143 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5 (execute): 14:27:53.427641 => 14:27:53.427653
[0m14:27:53.430203 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5
[0m14:27:53.431864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:53.432449 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m14:27:53.432977 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_fct_orders_gift_card_amount.ec93756487' was properly closed.
[0m14:27:53.433472 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_fct_orders_customer_id__customer_id__ref_raw_customers_.6f6aeca3cd' was properly closed.
[0m14:27:53.433968 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m14:27:53.445242 [debug] [MainThread]: Command end result
[0m14:27:53.475128 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m14:27:53.475709 [info ] [MainThread]: Building catalog
[0m14:27:53.481492 [debug] [ThreadPool]: Acquiring new snowflake connection 'raw.information_schema'
[0m14:27:53.505916 [debug] [ThreadPool]: Using snowflake connection "raw.information_schema"
[0m14:27:53.507207 [debug] [ThreadPool]: On raw.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "raw.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from raw.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('dim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('fct_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_payments')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from raw.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('dim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('fct_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_payments')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('jaffle_shop')
                    and upper("table_name") = upper('stg_payments')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m14:27:53.508362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:56.753824 [debug] [ThreadPool]: SQL status: SUCCESS 39 in 3.0 seconds
[0m14:27:56.766968 [debug] [ThreadPool]: On raw.information_schema: Close
[0m14:27:56.879520 [info ] [MainThread]: Catalog written to /Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/target/catalog.json
[0m14:27:56.882270 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.123285, "process_user_time": 3.816736, "process_kernel_time": 0.549172, "process_mem_max_rss": "131997696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:56.883049 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:27:56.882909 after 6.12 seconds
[0m14:27:56.883421 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:27:56.883725 [debug] [MainThread]: Connection 'raw.information_schema' was properly closed.
[0m14:27:56.884079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110078950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11003fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111263210>]}
[0m14:27:56.884486 [debug] [MainThread]: Flushing usage events
[0m14:28:04.289468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108486410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d3f90>]}


============================== 14:28:04.293909 | 842ac125-f63c-421b-8bbf-01342c0a5115 ==============================
[0m14:28:04.293909 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:28:04.294632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/gabriellechen/.dbt', 'log_path': '/Users/gabriellechen/Documents/dbtfundamentals/DBT_fundamentals/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:04.626527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842ac125-f63c-421b-8bbf-01342c0a5115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c60590>]}
[0m14:28:04.725828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '842ac125-f63c-421b-8bbf-01342c0a5115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8bfd0>]}
[0m14:28:04.999894 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m14:28:05.011647 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.11/3.11.7_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 456, in __init__
    self.server_bind()
  File "/usr/local/Cellar/python@3.11/3.11.7_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m14:28:05.015867 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.77852213, "process_user_time": 2.447388, "process_kernel_time": 0.324414, "process_mem_max_rss": "112656384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:05.016862 [debug] [MainThread]: Command `dbt docs serve` failed at 14:28:05.016693 after 0.78 seconds
[0m14:28:05.017407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097694d0>]}
[0m14:28:05.019327 [debug] [MainThread]: Flushing usage events
